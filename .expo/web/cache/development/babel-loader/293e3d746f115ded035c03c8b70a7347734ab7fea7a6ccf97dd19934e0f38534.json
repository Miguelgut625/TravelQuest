{"ast":null,"code":"import { createClient } from '@supabase/supabase-js';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport 'react-native-url-polyfill/auto';\nimport { LOGGING_CONFIG } from '../config/logging';\nconst supabaseUrl = 'https://ynyxyzzpbyzyejgkfncm.supabase.co';\nconst supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlueXh5enpwYnl6eWVqZ2tmbmNtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE3ODI4NDMsImV4cCI6MjA1NzM1ODg0M30.ntEnr5gFT5tllc0Z037LJPkPq60SM_RBLa6hct72xXs';\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    storage: AsyncStorage,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: false,\n    flowType: 'implicit',\n    debug: LOGGING_CONFIG.CATEGORIES.AUTH\n  }\n});\nsupabase.auth.onAuthStateChange((event, session) => {\n  console.log('Auth state changed:', event);\n  if (event === 'TOKEN_REFRESHED' || event === 'SIGNED_IN') {\n    console.log('Token refreshed successfully');\n  } else if (event === 'SIGNED_OUT') {\n    console.log('User signed out');\n  }\n});\nexport const refreshSession = async () => {\n  try {\n    console.log('Intentando refrescar la sesión...');\n    const {\n      data,\n      error\n    } = await supabase.auth.refreshSession();\n    if (error) {\n      console.error('Error refreshing session:', error);\n      return {\n        success: false,\n        error\n      };\n    }\n    console.log('Sesión refrescada exitosamente');\n    return {\n      success: true,\n      data\n    };\n  } catch (error) {\n    console.error('Error inesperado al refrescar sesión:', error);\n    return {\n      success: false,\n      error\n    };\n  }\n};\nexport const ensureValidSession = async () => {\n  try {\n    const {\n      data: {\n        session\n      }\n    } = await supabase.auth.getSession();\n    if (!session) {\n      console.log('No hay sesión activa');\n      return {\n        valid: false\n      };\n    }\n    const expiresAt = new Date(session.expires_at || 0);\n    const now = new Date();\n    const fiveMinutes = 5 * 60 * 1000;\n    if (expiresAt.getTime() - now.getTime() < fiveMinutes) {\n      console.log('Token cerca de expirar, refrescando...');\n      const {\n        success,\n        data,\n        error\n      } = await refreshSession();\n      if (!success) {\n        console.error('No se pudo refrescar el token:', error);\n        return {\n          valid: false,\n          error\n        };\n      }\n      return {\n        valid: true,\n        session: data.session\n      };\n    }\n    return {\n      valid: true,\n      session\n    };\n  } catch (error) {\n    console.error('Error al verificar la sesión:', error);\n    return {\n      valid: false,\n      error\n    };\n  }\n};\nexport const testAuth = async (email, password) => {\n  try {\n    console.log('Probando autenticación con:', {\n      email\n    });\n    const {\n      data,\n      error\n    } = await supabase.auth.signInWithPassword({\n      email,\n      password\n    });\n    if (error) {\n      console.error('Error en prueba de autenticación:', {\n        message: error.message,\n        status: error.status,\n        name: error.name\n      });\n      return {\n        success: false,\n        error\n      };\n    }\n    console.log('Prueba de autenticación exitosa:', {\n      user: data.user?.email,\n      session: !!data.session\n    });\n    return {\n      success: true,\n      data\n    };\n  } catch (error) {\n    console.error('Error inesperado en prueba de autenticación:', error);\n    return {\n      success: false,\n      error\n    };\n  }\n};\nexport const uploadImage = async (filePath, bucket) => {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.storage.from(bucket).upload(filePath, filePath);\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error uploading image:', error);\n    throw error;\n  }\n};\nexport const getMissionsByCity = async cityId => {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.from('missions').select('*').eq('cityId', cityId);\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching missions:', error);\n    throw error;\n  }\n};\nexport const updateMissionProgress = async (missionId, userId, completed) => {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.from('mission_progress').upsert({\n      mission_id: missionId,\n      user_id: userId,\n      completed,\n      updated_at: new Date().toISOString()\n    });\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error updating mission progress:', error);\n    throw error;\n  }\n};\nexport const verifyCredentials = async (email, password) => {\n  try {\n    console.log('Verificando credenciales para:', email);\n    const {\n      data: authData,\n      error: authError\n    } = await supabase.auth.signInWithPassword({\n      email,\n      password\n    });\n    if (authError) {\n      console.error('Error en autenticación:', authError);\n      return {\n        success: false,\n        error: authError\n      };\n    }\n    if (!authData.user) {\n      console.log('No se encontró el usuario');\n      return {\n        success: false,\n        error: new Error('Usuario no encontrado')\n      };\n    }\n    const {\n      data: userData,\n      error: userError\n    } = await supabase.from('users').select('*').eq('email', email).single();\n    if (userError) {\n      console.error('Error obteniendo datos del usuario:', userError);\n      return {\n        success: false,\n        error: userError\n      };\n    }\n    const userInfo = Object.assign({}, userData, {\n      email: authData.user.email\n    });\n    console.log('Autenticación exitosa para:', email);\n    return {\n      success: true,\n      data: userInfo\n    };\n  } catch (error) {\n    console.error('Error inesperado en autenticación:', error);\n    return {\n      success: false,\n      error\n    };\n  }\n};\nexport const searchCities = async searchTerm => {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.from('cities').select('*').ilike('name', `%${searchTerm}%`).limit(5);\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error searching cities:', error);\n    return [];\n  }\n};","map":{"version":3,"names":["createClient","AsyncStorage","LOGGING_CONFIG","supabaseUrl","supabaseAnonKey","supabase","auth","storage","autoRefreshToken","persistSession","detectSessionInUrl","flowType","debug","CATEGORIES","AUTH","onAuthStateChange","event","session","console","log","refreshSession","data","error","success","ensureValidSession","getSession","valid","expiresAt","Date","expires_at","now","fiveMinutes","getTime","testAuth","email","password","signInWithPassword","message","status","name","user","uploadImage","filePath","bucket","from","upload","getMissionsByCity","cityId","select","eq","updateMissionProgress","missionId","userId","completed","upsert","mission_id","user_id","updated_at","toISOString","verifyCredentials","authData","authError","Error","userData","userError","single","userInfo","Object","assign","searchCities","searchTerm","ilike","limit"],"sources":["C:/Users/Dani/TravelQuest/src/services/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport 'react-native-url-polyfill/auto';\r\nimport { LOGGING_CONFIG } from '../config/logging';\r\n\r\nconst supabaseUrl = 'https://ynyxyzzpbyzyejgkfncm.supabase.co';\r\nconst supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlueXh5enpwYnl6eWVqZ2tmbmNtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE3ODI4NDMsImV4cCI6MjA1NzM1ODg0M30.ntEnr5gFT5tllc0Z037LJPkPq60SM_RBLa6hct72xXs';\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    storage: AsyncStorage,\r\n    autoRefreshToken: true,\r\n    persistSession: true,\r\n    detectSessionInUrl: false,\r\n    flowType: 'implicit',\r\n    debug: LOGGING_CONFIG.CATEGORIES.AUTH\r\n  }\r\n});\r\n\r\n// Agregar un listener para errores de autenticación\r\nsupabase.auth.onAuthStateChange((event, session) => {\r\n  console.log('Auth state changed:', event);\r\n  \r\n  // Si el token expiró o hubo un error, intentamos refrescar la sesión\r\n  if (event === 'TOKEN_REFRESHED' || event === 'SIGNED_IN') {\r\n    console.log('Token refreshed successfully');\r\n  } else if (event === 'SIGNED_OUT') {\r\n    console.log('User signed out');\r\n  }\r\n});\r\n\r\n// Función para refrescar manualmente la sesión\r\nexport const refreshSession = async () => {\r\n  try {\r\n    console.log('Intentando refrescar la sesión...');\r\n    const { data, error } = await supabase.auth.refreshSession();\r\n    \r\n    if (error) {\r\n      console.error('Error refreshing session:', error);\r\n      return { success: false, error };\r\n    }\r\n    \r\n    console.log('Sesión refrescada exitosamente');\r\n    return { success: true, data };\r\n  } catch (error) {\r\n    console.error('Error inesperado al refrescar sesión:', error);\r\n    return { success: false, error };\r\n  }\r\n};\r\n\r\n// Función para verificar y refrescar la sesión antes de operaciones críticas\r\nexport const ensureValidSession = async () => {\r\n  try {\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    \r\n    if (!session) {\r\n      console.log('No hay sesión activa');\r\n      return { valid: false };\r\n    }\r\n    \r\n    // Verificar si el token expira en menos de 5 minutos\r\n    const expiresAt = new Date(session.expires_at || 0);\r\n    const now = new Date();\r\n    const fiveMinutes = 5 * 60 * 1000;\r\n    \r\n    if (expiresAt.getTime() - now.getTime() < fiveMinutes) {\r\n      console.log('Token cerca de expirar, refrescando...');\r\n      const { success, data, error } = await refreshSession();\r\n      \r\n      if (!success) {\r\n        console.error('No se pudo refrescar el token:', error);\r\n        return { valid: false, error };\r\n      }\r\n      \r\n      return { valid: true, session: data.session };\r\n    }\r\n    \r\n    return { valid: true, session };\r\n  } catch (error) {\r\n    console.error('Error al verificar la sesión:', error);\r\n    return { valid: false, error };\r\n  }\r\n};\r\n\r\n// Función para probar la autenticación\r\nexport const testAuth = async (email: string, password: string) => {\r\n  try {\r\n    console.log('Probando autenticación con:', { email });\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password\r\n    });\r\n\r\n    if (error) {\r\n      console.error('Error en prueba de autenticación:', {\r\n        message: error.message,\r\n        status: error.status,\r\n        name: error.name\r\n      });\r\n      return { success: false, error };\r\n    }\r\n\r\n    console.log('Prueba de autenticación exitosa:', {\r\n      user: data.user?.email,\r\n      session: !!data.session\r\n    });\r\n    return { success: true, data };\r\n  } catch (error) {\r\n    console.error('Error inesperado en prueba de autenticación:', error);\r\n    return { success: false, error };\r\n  }\r\n};\r\n\r\n// Funciones auxiliares para interactuar con Supabase\r\nexport const uploadImage = async (filePath: string, bucket: string) => {\r\n  try {\r\n    const { data, error } = await supabase.storage\r\n      .from(bucket)\r\n      .upload(filePath, filePath);\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error uploading image:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getMissionsByCity = async (cityId: string) => {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('missions')\r\n      .select('*')\r\n      .eq('cityId', cityId);\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error fetching missions:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const updateMissionProgress = async (missionId: string, userId: string, completed: boolean) => {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('mission_progress')\r\n      .upsert({\r\n        mission_id: missionId,\r\n        user_id: userId,\r\n        completed,\r\n        updated_at: new Date().toISOString(),\r\n      });\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error updating mission progress:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Función para verificar credenciales de forma segura\r\nexport const verifyCredentials = async (email: string, password: string) => {\r\n  try {\r\n    console.log('Verificando credenciales para:', email);\r\n    \r\n    // Usar el sistema de autenticación incorporado de Supabase\r\n    const { data: authData, error: authError } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password\r\n    });\r\n\r\n    if (authError) {\r\n      console.error('Error en autenticación:', authError);\r\n      return { success: false, error: authError };\r\n    }\r\n\r\n    if (!authData.user) {\r\n      console.log('No se encontró el usuario');\r\n      return { success: false, error: new Error('Usuario no encontrado') };\r\n    }\r\n\r\n    // Obtener datos adicionales del usuario si es necesario\r\n    const { data: userData, error: userError } = await supabase\r\n      .from('users')\r\n      .select('*')\r\n      .eq('email', email)\r\n      .single();\r\n\r\n    if (userError) {\r\n      console.error('Error obteniendo datos del usuario:', userError);\r\n      return { success: false, error: userError };\r\n    }\r\n\r\n    const userInfo = {\r\n      ...userData,\r\n      email: authData.user.email\r\n    };\r\n\r\n    console.log('Autenticación exitosa para:', email);\r\n    return { success: true, data: userInfo };\r\n  } catch (error) {\r\n    console.error('Error inesperado en autenticación:', error);\r\n    return { success: false, error };\r\n  }\r\n};\r\n\r\nexport const searchCities = async (searchTerm: string) => {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('cities')\r\n      .select('*')\r\n      .ilike('name', `%${searchTerm}%`)\r\n      .limit(5);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error searching cities:', error);\r\n    return [];\r\n  }\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}