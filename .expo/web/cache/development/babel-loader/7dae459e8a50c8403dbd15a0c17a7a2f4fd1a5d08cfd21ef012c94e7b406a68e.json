{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { supabase } from \"./supabase\";\nvar generateMission = function () {\n  var _ref = _asyncToGenerator(function* (city, duration, missionCount) {\n    try {\n      var response = yield fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': \"Bearer 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\"\n        },\n        body: JSON.stringify({\n          model: 'gpt-3.5-turbo',\n          messages: [{\n            role: 'user',\n            content: \"Genera \" + missionCount + \" misiones en \" + city + \" que se puedan completar en \" + duration + \" d\\xEDas. Haz que la dificultad sea F\\xE1cil, Media o Dif\\xEDcil.\"\n          }]\n        })\n      });\n      var data = yield response.json();\n      console.log('Respuesta de la API:', data);\n      if (response.status !== 200) {\n        throw new Error(data.error.message || 'Error al generar misiones');\n      }\n      var missions = data.choices.map(function (choice) {\n        var title = choice.message.content;\n        var description = \"Descripci\\xF3n de la misi\\xF3n en \" + city + \".\";\n        var difficulty = ['Fácil', 'Media', 'Difícil'][Math.floor(Math.random() * 3)];\n        var points = difficulty === 'Fácil' ? 25 : difficulty === 'Media' ? 50 : 100;\n        return {\n          title: title,\n          description: description,\n          city: city,\n          duration: duration,\n          difficulty: difficulty,\n          points: points,\n          completed: false\n        };\n      });\n      var _yield$supabase$from$ = yield supabase.from('missions').insert(missions),\n        error = _yield$supabase$from$.error;\n      if (error) {\n        console.error('Error saving missions:', error);\n      } else {\n        console.log('Misiones guardadas exitosamente');\n      }\n    } catch (error) {\n      console.error('Error generating missions:', error);\n    }\n  });\n  return function generateMission(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default generateMission;","map":{"version":3,"names":["supabase","generateMission","_ref","_asyncToGenerator","city","duration","missionCount","response","fetch","method","headers","body","JSON","stringify","model","messages","role","content","data","json","console","log","status","Error","error","message","missions","choices","map","choice","title","description","difficulty","Math","floor","random","points","completed","_yield$supabase$from$","from","insert","_x","_x2","_x3","apply","arguments"],"sources":["C:/Users/migue/TravelQuest/src/services/missionGenerator.ts"],"sourcesContent":["import { supabase } from './supabase';\r\n\r\nconst generateMission = async (city: string, duration: number, missionCount: number) => {\r\n  try {\r\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer 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`, \r\n       },\r\n      body: JSON.stringify({\r\n        model: 'gpt-3.5-turbo',\r\n        messages: [\r\n          {\r\n            role: 'user',\r\n            content: `Genera ${missionCount} misiones en ${city} que se puedan completar en ${duration} días. Haz que la dificultad sea Fácil, Media o Difícil.`\r\n          }\r\n        ],\r\n      }),\r\n    });\r\n\r\n    const data = await response.json();\r\n    console.log('Respuesta de la API:', data);\r\n\r\n    if (response.status !== 200) {\r\n      throw new Error(data.error.message || 'Error al generar misiones');\r\n    }\r\n\r\n    const missions = data.choices.map((choice: any) => {\r\n      const title = choice.message.content; // Ajusta según la respuesta de la API\r\n      const description = `Descripción de la misión en ${city}.`; // Ajusta según la respuesta de la API\r\n\r\n      // Determinar la dificultad y los puntos\r\n      const difficulty = ['Fácil', 'Media', 'Difícil'][Math.floor(Math.random() * 3)];\r\n      const points = difficulty === 'Fácil' ? 25 : difficulty === 'Media' ? 50 : 100;\r\n\r\n      return {\r\n        title,\r\n        description,\r\n        city,\r\n        duration,\r\n        difficulty,\r\n        points,\r\n        completed: false,\r\n      };\r\n    });\r\n\r\n    // Guardar las misiones en Supabase\r\n    const { error } = await supabase\r\n      .from('missions')\r\n      .insert(missions);\r\n\r\n    if (error) {\r\n      console.error('Error saving missions:', error);\r\n    } else {\r\n      console.log('Misiones guardadas exitosamente');\r\n    }\r\n  } catch (error) {\r\n    console.error('Error generating missions:', error);\r\n  }\r\n};\r\n\r\nexport default generateMission;\r\n"],"mappings":";AAAA,SAASA,QAAQ;AAEjB,IAAMC,eAAe;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOC,IAAY,EAAEC,QAAgB,EAAEC,YAAoB,EAAK;IACtF,IAAI;MACF,IAAMC,QAAQ,SAASC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClC,eAAe;QAChB,CAAC;QACFC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnBC,KAAK,EAAE,eAAe;UACtBC,QAAQ,EAAE,CACR;YACEC,IAAI,EAAE,MAAM;YACZC,OAAO,cAAYX,YAAY,qBAAgBF,IAAI,oCAA+BC,QAAQ;UAC5F,CAAC;QAEL,CAAC;MACH,CAAC,CAAC;MAEF,IAAMa,IAAI,SAASX,QAAQ,CAACY,IAAI,CAAC,CAAC;MAClCC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEH,IAAI,CAAC;MAEzC,IAAIX,QAAQ,CAACe,MAAM,KAAK,GAAG,EAAE;QAC3B,MAAM,IAAIC,KAAK,CAACL,IAAI,CAACM,KAAK,CAACC,OAAO,IAAI,2BAA2B,CAAC;MACpE;MAEA,IAAMC,QAAQ,GAAGR,IAAI,CAACS,OAAO,CAACC,GAAG,CAAC,UAACC,MAAW,EAAK;QACjD,IAAMC,KAAK,GAAGD,MAAM,CAACJ,OAAO,CAACR,OAAO;QACpC,IAAMc,WAAW,0CAAkC3B,IAAI,MAAG;QAG1D,IAAM4B,UAAU,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC/E,IAAMC,MAAM,GAAGJ,UAAU,KAAK,OAAO,GAAG,EAAE,GAAGA,UAAU,KAAK,OAAO,GAAG,EAAE,GAAG,GAAG;QAE9E,OAAO;UACLF,KAAK,EAALA,KAAK;UACLC,WAAW,EAAXA,WAAW;UACX3B,IAAI,EAAJA,IAAI;UACJC,QAAQ,EAARA,QAAQ;UACR2B,UAAU,EAAVA,UAAU;UACVI,MAAM,EAANA,MAAM;UACNC,SAAS,EAAE;QACb,CAAC;MACH,CAAC,CAAC;MAGF,IAAAC,qBAAA,SAAwBtC,QAAQ,CAC7BuC,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAACd,QAAQ,CAAC;QAFXF,KAAK,GAAAc,qBAAA,CAALd,KAAK;MAIb,IAAIA,KAAK,EAAE;QACTJ,OAAO,CAACI,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAChD,CAAC,MAAM;QACLJ,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;MAChD;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IACpD;EACF,CAAC;EAAA,gBA1DKvB,eAAeA,CAAAwC,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAAzC,IAAA,CAAA0C,KAAA,OAAAC,SAAA;EAAA;AAAA,GA0DpB;AAED,eAAe5C,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}