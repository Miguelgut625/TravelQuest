{"ast":null,"code":"import { supabase } from './supabase';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport NotificationService from './NotificationService';\nexport const shareJourney = async (journeyId, ownerId, friend) => {\n  if (!journeyId) {\n    Alert.alert('Error', 'No se pudo compartir el journey porque no se encontró el ID del viaje.');\n    return false;\n  }\n  try {\n    const {\n      data: journeyData,\n      error: journeyError\n    } = await supabase.from('journeys').select('description').eq('id', journeyId).single();\n    if (journeyError) throw journeyError;\n    const {\n      data: userData,\n      error: userError\n    } = await supabase.from('users').select('username').eq('id', ownerId).single();\n    if (userError) throw userError;\n    const {\n      error\n    } = await supabase.from('journeys_shared').insert({\n      journeyId,\n      ownerId,\n      sharedWithUserId: friend.user2Id\n    });\n    if (error) throw error;\n    const notificationService = NotificationService.getInstance();\n    await notificationService.notifyJourneyShared(friend.user2Id, journeyData.description, userData.username);\n    Alert.alert('Éxito', `Journey compartido con ${friend.username}`);\n    return true;\n  } catch (err) {\n    console.error(err);\n    Alert.alert('Error', 'No se pudo compartir el journey');\n    return false;\n  }\n};","map":{"version":3,"names":["supabase","Alert","NotificationService","shareJourney","journeyId","ownerId","friend","alert","data","journeyData","error","journeyError","from","select","eq","single","userData","userError","insert","sharedWithUserId","user2Id","notificationService","getInstance","notifyJourneyShared","description","username","err","console"],"sources":["C:/Users/Admin/TravelQuest/src/services/shareService.ts"],"sourcesContent":["import { supabase } from './supabase';\r\nimport { Alert } from 'react-native';\r\nimport NotificationService from './NotificationService';\r\n\r\ninterface Friend {\r\n    user2Id: string;\r\n    username: string;\r\n    points: number;\r\n}\r\n\r\nexport const shareJourney = async (\r\n    journeyId: string,\r\n    ownerId: string,\r\n    friend: Friend\r\n): Promise<boolean> => {\r\n    if (!journeyId) {\r\n        Alert.alert('Error', 'No se pudo compartir el journey porque no se encontró el ID del viaje.');\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        // Obtener el nombre del viaje\r\n        const { data: journeyData, error: journeyError } = await supabase\r\n            .from('journeys')\r\n            .select('description')\r\n            .eq('id', journeyId)\r\n            .single();\r\n\r\n        if (journeyError) throw journeyError;\r\n\r\n        // Obtener el nombre del usuario que comparte\r\n        const { data: userData, error: userError } = await supabase\r\n            .from('users')\r\n            .select('username')\r\n            .eq('id', ownerId)\r\n            .single();\r\n\r\n        if (userError) throw userError;\r\n\r\n        // Compartir el viaje\r\n        const { error } = await supabase\r\n            .from('journeys_shared')\r\n            .insert({\r\n                journeyId,\r\n                ownerId,\r\n                sharedWithUserId: friend.user2Id\r\n            });\r\n\r\n        if (error) throw error;\r\n\r\n        // Enviar notificación al amigo\r\n        const notificationService = NotificationService.getInstance();\r\n        await notificationService.notifyJourneyShared(\r\n            friend.user2Id,\r\n            journeyData.description,\r\n            userData.username\r\n        );\r\n\r\n        Alert.alert('Éxito', `Journey compartido con ${friend.username}`);\r\n        return true;\r\n    } catch (err) {\r\n        console.error(err);\r\n        Alert.alert('Error', 'No se pudo compartir el journey');\r\n        return false;\r\n    }\r\n}; "],"mappings":"AAAA,SAASA,QAAQ,QAAQ,YAAY;AAAC,OAAAC,KAAA;AAEtC,OAAOC,mBAAmB,MAAM,uBAAuB;AAQvD,OAAO,MAAMC,YAAY,GAAG,MAAAA,CACxBC,SAAiB,EACjBC,OAAe,EACfC,MAAc,KACK;EACnB,IAAI,CAACF,SAAS,EAAE;IACZH,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,wEAAwE,CAAC;IAC9F,OAAO,KAAK;EAChB;EAEA,IAAI;IAEA,MAAM;MAAEC,IAAI,EAAEC,WAAW;MAAEC,KAAK,EAAEC;IAAa,CAAC,GAAG,MAAMX,QAAQ,CAC5DY,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC,aAAa,CAAC,CACrBC,EAAE,CAAC,IAAI,EAAEV,SAAS,CAAC,CACnBW,MAAM,CAAC,CAAC;IAEb,IAAIJ,YAAY,EAAE,MAAMA,YAAY;IAGpC,MAAM;MAAEH,IAAI,EAAEQ,QAAQ;MAAEN,KAAK,EAAEO;IAAU,CAAC,GAAG,MAAMjB,QAAQ,CACtDY,IAAI,CAAC,OAAO,CAAC,CACbC,MAAM,CAAC,UAAU,CAAC,CAClBC,EAAE,CAAC,IAAI,EAAET,OAAO,CAAC,CACjBU,MAAM,CAAC,CAAC;IAEb,IAAIE,SAAS,EAAE,MAAMA,SAAS;IAG9B,MAAM;MAAEP;IAAM,CAAC,GAAG,MAAMV,QAAQ,CAC3BY,IAAI,CAAC,iBAAiB,CAAC,CACvBM,MAAM,CAAC;MACJd,SAAS;MACTC,OAAO;MACPc,gBAAgB,EAAEb,MAAM,CAACc;IAC7B,CAAC,CAAC;IAEN,IAAIV,KAAK,EAAE,MAAMA,KAAK;IAGtB,MAAMW,mBAAmB,GAAGnB,mBAAmB,CAACoB,WAAW,CAAC,CAAC;IAC7D,MAAMD,mBAAmB,CAACE,mBAAmB,CACzCjB,MAAM,CAACc,OAAO,EACdX,WAAW,CAACe,WAAW,EACvBR,QAAQ,CAACS,QACb,CAAC;IAEDxB,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,0BAA0BD,MAAM,CAACmB,QAAQ,EAAE,CAAC;IACjE,OAAO,IAAI;EACf,CAAC,CAAC,OAAOC,GAAG,EAAE;IACVC,OAAO,CAACjB,KAAK,CAACgB,GAAG,CAAC;IAClBzB,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,iCAAiC,CAAC;IACvD,OAAO,KAAK;EAChB;AACJ,CAAC","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}