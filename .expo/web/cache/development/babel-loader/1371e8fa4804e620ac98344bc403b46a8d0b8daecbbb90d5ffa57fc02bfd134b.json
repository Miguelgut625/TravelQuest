{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport * as Location from 'expo-location';\nimport { useNavigation } from '@react-navigation/native';\nimport generateMission from \"../../services/missionGenerator\";\nimport { Ionicons } from '@expo/vector-icons';\nimport { Calendar } from 'react-native-calendars';\nimport { format } from 'date-fns';\nimport { searchCities } from \"../../services/supabase\";\nimport SimpleWebView from \"../../components/SimpleWebView\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar _Dimensions$get = Dimensions.get('window'),\n  width = _Dimensions$get.width,\n  height = _Dimensions$get.height;\nvar LoadingModal = function LoadingModal(_ref) {\n  var visible = _ref.visible,\n    currentStep = _ref.currentStep;\n  return _jsx(Modal, {\n    transparent: true,\n    visible: visible,\n    animationType: \"fade\",\n    children: _jsx(View, {\n      style: styles.modalContainer,\n      children: _jsxs(View, {\n        style: styles.loadingCard,\n        children: [_jsx(ActivityIndicator, {\n          size: \"large\",\n          color: \"#4CAF50\"\n        }), _jsx(Text, {\n          style: styles.loadingTitle,\n          children: \"Generando tu aventura\"\n        }), _jsx(Text, {\n          style: styles.loadingStep,\n          children: currentStep\n        }), _jsx(View, {\n          style: styles.progressBar,\n          children: _jsx(View, {\n            style: [styles.progressFill, {\n              width: currentStep.includes('Preparando') ? '30%' : currentStep.includes('Buscando') ? '60%' : currentStep.includes('Creando') ? '90%' : '10%'\n            }]\n          })\n        })]\n      })\n    })\n  });\n};\nvar DateRangePickerMobile = function DateRangePickerMobile(_ref2) {\n  var startDateProp = _ref2.startDateProp,\n    endDateProp = _ref2.endDateProp,\n    onDatesChange = _ref2.onDatesChange;\n  var _useState = useState(startDateProp),\n    _useState2 = _slicedToArray(_useState, 2),\n    startDate = _useState2[0],\n    setStartDate = _useState2[1];\n  var _useState3 = useState(endDateProp),\n    _useState4 = _slicedToArray(_useState3, 2),\n    endDate = _useState4[0],\n    setEndDate = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isOpen = _useState6[0],\n    setIsOpen = _useState6[1];\n  var _useState7 = useState({}),\n    _useState8 = _slicedToArray(_useState7, 2),\n    selectedDates = _useState8[0],\n    setSelectedDates = _useState8[1];\n  useEffect(function () {\n    setStartDate(startDateProp);\n    setEndDate(endDateProp);\n    if (startDateProp || endDateProp) {\n      updateMarkedDates(startDateProp, endDateProp);\n    }\n  }, [startDateProp, endDateProp]);\n  var updateMarkedDates = function updateMarkedDates(start, end) {\n    var newMarkedDates = {};\n    if (start) {\n      var startStr = format(start, 'yyyy-MM-dd');\n      newMarkedDates[startStr] = {\n        startingDay: true,\n        color: '#005F9E',\n        textColor: 'white'\n      };\n    }\n    if (end) {\n      var endStr = format(end, 'yyyy-MM-dd');\n      newMarkedDates[endStr] = {\n        endingDay: true,\n        color: '#005F9E',\n        textColor: 'white'\n      };\n    }\n    if (start && end) {\n      var currentDate = new Date(start);\n      currentDate.setDate(currentDate.getDate() + 1);\n      while (currentDate < end) {\n        var dateStr = format(currentDate, 'yyyy-MM-dd');\n        newMarkedDates[dateStr] = {\n          color: '#e5f3ff',\n          textColor: '#005F9E'\n        };\n        currentDate.setDate(currentDate.getDate() + 1);\n      }\n    }\n    setSelectedDates(newMarkedDates);\n  };\n  var handleDayPress = function handleDayPress(day) {\n    var selectedDate = new Date(day.dateString);\n    if (!startDate || startDate && endDate) {\n      var newStart = selectedDate;\n      setStartDate(newStart);\n      setEndDate(null);\n      updateMarkedDates(newStart, null);\n      onDatesChange([newStart, null]);\n    } else {\n      if (selectedDate < startDate) {\n        var newEnd = new Date(startDate);\n        setEndDate(newEnd);\n        setStartDate(selectedDate);\n        updateMarkedDates(selectedDate, newEnd);\n        onDatesChange([selectedDate, newEnd]);\n      } else {\n        setEndDate(selectedDate);\n        updateMarkedDates(startDate, selectedDate);\n        onDatesChange([startDate, selectedDate]);\n      }\n    }\n  };\n  var calculateDuration = function calculateDuration(start, end) {\n    if (!start || !end) return 0;\n    var diffTime = Math.abs(end.getTime() - start.getTime());\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n  var formatDateRange = function formatDateRange() {\n    if (!startDate && !endDate) {\n      return 'Selecciona fechas';\n    }\n    var formatDate = function formatDate(date) {\n      if (!date) return '';\n      return format(date, 'dd MMM');\n    };\n    var duration = calculateDuration(startDate, endDate);\n    var startStr = formatDate(startDate);\n    var endStr = formatDate(endDate);\n    if (startStr && endStr) {\n      return `${startStr} - ${endStr} Â· ${duration} noches`;\n    } else if (startStr) {\n      return `${startStr} - Selecciona fecha final`;\n    } else {\n      return 'Selecciona fechas';\n    }\n  };\n  return _jsxs(View, {\n    style: styles.datePickerContainer,\n    children: [_jsx(TouchableOpacity, {\n      style: styles.datePickerButton,\n      onPress: function onPress() {\n        return setIsOpen(!isOpen);\n      },\n      children: _jsxs(View, {\n        style: styles.datePickerContent,\n        children: [_jsx(Text, {\n          style: styles.datePickerText,\n          children: formatDateRange()\n        }), _jsx(Ionicons, {\n          name: isOpen ? 'chevron-up' : 'chevron-down',\n          size: 24,\n          color: \"white\"\n        })]\n      })\n    }), isOpen && _jsx(View, {\n      style: styles.calendarDropdown,\n      children: _jsx(Calendar, {\n        minDate: new Date().toISOString().split('T')[0],\n        onDayPress: handleDayPress,\n        markingType: \"period\",\n        markedDates: selectedDates,\n        theme: {\n          calendarBackground: '#ffffff',\n          textSectionTitleColor: '#b6c1cd',\n          selectedDayBackgroundColor: '#005F9E',\n          selectedDayTextColor: '#ffffff',\n          todayTextColor: '#005F9E',\n          dayTextColor: '#2d4150',\n          textDisabledColor: '#d9e1e8',\n          dotColor: '#005F9E',\n          selectedDotColor: '#ffffff',\n          arrowColor: '#005F9E',\n          monthTextColor: '#005F9E',\n          indicatorColor: '#005F9E'\n        }\n      })\n    })]\n  });\n};\nvar DateRangePickerWeb = function DateRangePickerWeb(_ref3) {\n  var startDateProp = _ref3.startDateProp,\n    endDateProp = _ref3.endDateProp,\n    onDatesChange = _ref3.onDatesChange;\n  var _useState9 = useState(startDateProp),\n    _useState10 = _slicedToArray(_useState9, 2),\n    startDate = _useState10[0],\n    setStartDate = _useState10[1];\n  var _useState11 = useState(endDateProp),\n    _useState12 = _slicedToArray(_useState11, 2),\n    endDate = _useState12[0],\n    setEndDate = _useState12[1];\n  var _useState13 = useState(false),\n    _useState14 = _slicedToArray(_useState13, 2),\n    isOpen = _useState14[0],\n    setIsOpen = _useState14[1];\n  var _useState15 = useState(new Date()),\n    _useState16 = _slicedToArray(_useState15, 2),\n    currentMonth = _useState16[0],\n    setCurrentMonth = _useState16[1];\n  useEffect(function () {\n    setStartDate(startDateProp);\n    setEndDate(endDateProp);\n  }, [startDateProp, endDateProp]);\n  var generateCalendar = function generateCalendar(date) {\n    var year = date.getFullYear();\n    var month = date.getMonth();\n    var firstDay = new Date(year, month, 1);\n    var startingDayOfWeek = firstDay.getDay();\n    var lastDay = new Date(year, month + 1, 0);\n    var totalDays = lastDay.getDate();\n    var days = [];\n    for (var i = 0; i < startingDayOfWeek; i++) {\n      var prevMonthDay = new Date(year, month, -i);\n      days.unshift({\n        date: prevMonthDay,\n        isCurrentMonth: false,\n        isToday: false,\n        isSelected: false\n      });\n    }\n    var today = new Date();\n    today.setHours(0, 0, 0, 0);\n    for (var _i = 1; _i <= totalDays; _i++) {\n      var currentDate = new Date(year, month, _i);\n      currentDate.setHours(0, 0, 0, 0);\n      var isToday = currentDate.getTime() === today.getTime();\n      var isStartDate = startDate && currentDate.getTime() === new Date(startDate).setHours(0, 0, 0, 0);\n      var isEndDate = endDate && currentDate.getTime() === new Date(endDate).setHours(0, 0, 0, 0);\n      var isInRange = startDate && endDate && currentDate.getTime() > new Date(startDate).setHours(0, 0, 0, 0) && currentDate.getTime() < new Date(endDate).setHours(0, 0, 0, 0);\n      days.push({\n        date: currentDate,\n        isCurrentMonth: true,\n        isToday: isToday,\n        isSelected: isStartDate || isEndDate,\n        isStartDate: isStartDate,\n        isEndDate: isEndDate,\n        isInRange: isInRange\n      });\n    }\n    var remainingDays = 7 - days.length % 7;\n    if (remainingDays < 7) {\n      for (var _i2 = 1; _i2 <= remainingDays; _i2++) {\n        var nextMonthDay = new Date(year, month + 1, _i2);\n        days.push({\n          date: nextMonthDay,\n          isCurrentMonth: false,\n          isToday: false,\n          isSelected: false\n        });\n      }\n    }\n    return days;\n  };\n  var handleDateClick = function handleDateClick(date) {\n    var today = new Date();\n    today.setHours(0, 0, 0, 0);\n    if (date < today) {\n      return;\n    }\n    if (!startDate || startDate && endDate) {\n      setStartDate(date);\n      setEndDate(null);\n      onDatesChange([date, null]);\n    } else {\n      if (date < startDate) {\n        setEndDate(new Date(startDate));\n        setStartDate(date);\n        onDatesChange([date, startDate]);\n      } else {\n        setEndDate(date);\n        onDatesChange([startDate, date]);\n      }\n    }\n  };\n  var formatMonth = function formatMonth(date) {\n    var months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];\n    return `${months[date.getMonth()]} ${date.getFullYear()}`;\n  };\n  var changeMonth = function changeMonth(offset) {\n    var newMonth = new Date(currentMonth);\n    newMonth.setMonth(newMonth.getMonth() + offset);\n    setCurrentMonth(newMonth);\n  };\n  var days = generateCalendar(currentMonth);\n  var weekDays = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];\n  var calculateDuration = function calculateDuration(start, end) {\n    if (!start || !end) return 0;\n    var diffTime = Math.abs(end.getTime() - start.getTime());\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n  var formatDate = function formatDate(date) {\n    if (!date) return '';\n    return `${date.getDate()} ${['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic'][date.getMonth()]}`;\n  };\n  var formatDateRange = function formatDateRange() {\n    if (!startDate && !endDate) {\n      return 'Selecciona fechas';\n    }\n    var startStr = formatDate(startDate);\n    var endStr = formatDate(endDate);\n    var duration = calculateDuration(startDate, endDate);\n    if (startStr && endStr) {\n      return `${startStr} - ${endStr} Â· ${duration} noches`;\n    } else if (startStr) {\n      return `${startStr} - Selecciona fecha final`;\n    } else {\n      return 'Selecciona fechas';\n    }\n  };\n  return _jsxs(View, {\n    style: styles.datePickerContainer,\n    children: [_jsx(TouchableOpacity, {\n      style: styles.datePickerButton,\n      onPress: function onPress() {\n        return setIsOpen(!isOpen);\n      },\n      children: _jsxs(View, {\n        style: styles.datePickerContent,\n        children: [_jsx(Text, {\n          style: styles.datePickerText,\n          children: formatDateRange()\n        }), _jsx(Ionicons, {\n          name: isOpen ? 'chevron-up' : 'chevron-down',\n          size: 24,\n          color: \"white\"\n        })]\n      })\n    }), isOpen && _jsxs(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '100%',\n        left: 0,\n        right: 0,\n        backgroundColor: 'white',\n        zIndex: 9999,\n        boxShadow: '0px 2px 10px rgba(0,0,0,0.1)',\n        borderRadius: 8,\n        marginTop: 4,\n        padding: 15,\n        width: 620,\n        marginLeft: 'auto',\n        marginRight: 'auto'\n      },\n      children: [_jsxs(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          marginBottom: 10\n        },\n        children: [_jsxs(\"div\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'row',\n            alignItems: 'center'\n          },\n          children: [_jsx(\"button\", {\n            onClick: function onClick() {\n              return changeMonth(-1);\n            },\n            style: {\n              background: 'none',\n              border: 'none',\n              fontSize: 24,\n              cursor: 'pointer',\n              color: '#005F9E'\n            },\n            children: \"\\u2190\"\n          }), _jsx(\"h3\", {\n            style: {\n              margin: '0 15px',\n              color: '#005F9E'\n            },\n            children: formatMonth(currentMonth)\n          }), _jsx(\"button\", {\n            onClick: function onClick() {\n              return changeMonth(1);\n            },\n            style: {\n              background: 'none',\n              border: 'none',\n              fontSize: 24,\n              cursor: 'pointer',\n              color: '#005F9E'\n            },\n            children: \"\\u2192\"\n          })]\n        }), _jsx(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center'\n          },\n          children: _jsx(\"button\", {\n            onClick: function onClick() {\n              setStartDate(null);\n              setEndDate(null);\n              onDatesChange([null, null]);\n            },\n            style: {\n              background: 'none',\n              border: '1px solid #ddd',\n              padding: '5px 10px',\n              borderRadius: 4,\n              cursor: 'pointer'\n            },\n            children: \"Limpiar\"\n          })\n        })]\n      }), _jsxs(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(7, 1fr)',\n          gap: 5,\n          textAlign: 'center'\n        },\n        children: [weekDays.map(function (day) {\n          return _jsx(\"div\", {\n            style: {\n              padding: 5,\n              fontWeight: 'bold',\n              color: '#666'\n            },\n            children: day\n          }, day);\n        }), days.map(function (day, index) {\n          return _jsx(\"div\", {\n            onClick: function onClick() {\n              return day.isCurrentMonth && handleDateClick(day.date);\n            },\n            style: {\n              padding: 10,\n              cursor: day.isCurrentMonth ? 'pointer' : 'default',\n              backgroundColor: day.isStartDate || day.isEndDate ? '#005F9E' : day.isInRange ? '#e5f3ff' : 'transparent',\n              color: day.isStartDate || day.isEndDate ? 'white' : !day.isCurrentMonth ? '#ccc' : day.isToday ? '#005F9E' : '#333',\n              fontWeight: day.isToday ? 'bold' : 'normal',\n              borderRadius: 4,\n              opacity: day.isCurrentMonth ? 1 : 0.5\n            },\n            children: day.date.getDate()\n          }, index);\n        })]\n      })]\n    })]\n  });\n};\nvar MapScreen = function MapScreen() {\n  var navigation = useNavigation();\n  var dispatch = useDispatch();\n  var _useSelector = useSelector(function (state) {\n      return state.auth;\n    }),\n    user = _useSelector.user;\n  var _useState17 = useState({\n      latitude: 40.416775,\n      longitude: -3.703790,\n      latitudeDelta: 0.0922,\n      longitudeDelta: 0.0421\n    }),\n    _useState18 = _slicedToArray(_useState17, 2),\n    region = _useState18[0],\n    setRegion = _useState18[1];\n  var _useState19 = useState(''),\n    _useState20 = _slicedToArray(_useState19, 2),\n    searchCity = _useState20[0],\n    setSearchCity = _useState20[1];\n  var _useState21 = useState(''),\n    _useState22 = _slicedToArray(_useState21, 2),\n    missionCount = _useState22[0],\n    setMissionCount = _useState22[1];\n  var _useState23 = useState(null),\n    _useState24 = _slicedToArray(_useState23, 2),\n    startDate = _useState24[0],\n    setStartDate = _useState24[1];\n  var _useState25 = useState(null),\n    _useState26 = _slicedToArray(_useState25, 2),\n    endDate = _useState26[0],\n    setEndDate = _useState26[1];\n  var _useState27 = useState(false),\n    _useState28 = _slicedToArray(_useState27, 2),\n    showStartDatePicker = _useState28[0],\n    setShowStartDatePicker = _useState28[1];\n  var _useState29 = useState(false),\n    _useState30 = _slicedToArray(_useState29, 2),\n    showEndDatePicker = _useState30[0],\n    setShowEndDatePicker = _useState30[1];\n  var _useState31 = useState(null),\n    _useState32 = _slicedToArray(_useState31, 2),\n    errorMsg = _useState32[0],\n    setErrorMsg = _useState32[1];\n  var _useState33 = useState(false),\n    _useState34 = _slicedToArray(_useState33, 2),\n    isLoading = _useState34[0],\n    setIsLoading = _useState34[1];\n  var _useState35 = useState(''),\n    _useState36 = _slicedToArray(_useState35, 2),\n    currentStep = _useState36[0],\n    setCurrentStep = _useState36[1];\n  var _useState37 = useState(false),\n    _useState38 = _slicedToArray(_useState37, 2),\n    hasLocationPermission = _useState38[0],\n    setHasLocationPermission = _useState38[1];\n  var _useState39 = useState(false),\n    _useState40 = _slicedToArray(_useState39, 2),\n    isLoadingLocation = _useState40[0],\n    setIsLoadingLocation = _useState40[1];\n  var _useState41 = useState(null),\n    _useState42 = _slicedToArray(_useState41, 2),\n    errorLocationMsg = _useState42[0],\n    setErrorLocationMsg = _useState42[1];\n  var _useState43 = useState([]),\n    _useState44 = _slicedToArray(_useState43, 2),\n    filteredCities = _useState44[0],\n    setFilteredCities = _useState44[1];\n  var _useState45 = useState(false),\n    _useState46 = _slicedToArray(_useState45, 2),\n    showSuggestions = _useState46[0],\n    setShowSuggestions = _useState46[1];\n  var _useState47 = useState(0),\n    _useState48 = _slicedToArray(_useState47, 2),\n    duration = _useState48[0],\n    setDuration = _useState48[1];\n  var _useState49 = useState({\n      latitude: 40.416775,\n      longitude: -3.703790\n    }),\n    _useState50 = _slicedToArray(_useState49, 2),\n    userLocation = _useState50[0],\n    setUserLocation = _useState50[1];\n  var _useState51 = useState([]),\n    _useState52 = _slicedToArray(_useState51, 2),\n    selectedTags = _useState52[0],\n    setSelectedTags = _useState52[1];\n  var availableTags = [{\n    id: 'gratis',\n    label: 'Gratuito'\n  }, {\n    id: 'naturaleza',\n    label: 'Naturaleza'\n  }, {\n    id: 'arquitectura',\n    label: 'Arquitectura'\n  }, {\n    id: 'arte',\n    label: 'Arte'\n  }, {\n    id: 'cultura',\n    label: 'Cultura'\n  }, {\n    id: 'gastronomia',\n    label: 'GastronomÃ­a'\n  }, {\n    id: 'historia',\n    label: 'Historia'\n  }, {\n    id: 'deportes',\n    label: 'Deportes'\n  }, {\n    id: 'compras',\n    label: 'Compras'\n  }, {\n    id: 'familia',\n    label: 'Familiar'\n  }];\n  var toggleTag = function toggleTag(tagId) {\n    setSelectedTags(function (prevTags) {\n      return prevTags.includes(tagId) ? prevTags.filter(function (id) {\n        return id !== tagId;\n      }) : [].concat(_toConsumableArray(prevTags), [tagId]);\n    });\n  };\n  useEffect(function () {\n    getLocation();\n  }, []);\n  var getLocation = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        console.log('Solicitando permisos de ubicaciÃ³n en segundo plano...');\n        var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          status = _yield$Location$reque.status;\n        console.log('Estado de permisos de ubicaciÃ³n:', status);\n        if (status !== 'granted') {\n          console.warn('Permiso de ubicaciÃ³n denegado');\n          setErrorLocationMsg('Permiso de ubicaciÃ³n denegado. Usando ubicaciÃ³n por defecto.');\n          return;\n        }\n        console.log('Permisos concedidos, obteniendo ubicaciÃ³n actual...');\n        var options = Platform.OS === 'android' ? {\n          accuracy: Location.Accuracy.Balanced,\n          timeInterval: 10000,\n          distanceInterval: 10,\n          mayShowUserSettingsDialog: true\n        } : {\n          accuracy: Location.Accuracy.Balanced\n        };\n        console.log('Usando opciones de ubicaciÃ³n:', JSON.stringify(options));\n        try {\n          console.log('Intentando obtener ubicaciÃ³n...');\n          var location = yield Location.getCurrentPositionAsync(options);\n          console.log('UbicaciÃ³n obtenida:', JSON.stringify(location.coords));\n          setUserLocation({\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude\n          });\n          setRegion({\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude,\n            latitudeDelta: 0.0922,\n            longitudeDelta: 0.0421\n          });\n        } catch (locationError) {\n          console.error('Error especÃ­fico al obtener ubicaciÃ³n:', locationError);\n          console.log('Intentando obtener Ãºltima ubicaciÃ³n conocida...');\n          try {\n            var lastLocation = yield Location.getLastKnownPositionAsync();\n            if (lastLocation) {\n              console.log('Ãltima ubicaciÃ³n conocida:', JSON.stringify(lastLocation.coords));\n              setUserLocation({\n                latitude: lastLocation.coords.latitude,\n                longitude: lastLocation.coords.longitude\n              });\n              setRegion({\n                latitude: lastLocation.coords.latitude,\n                longitude: lastLocation.coords.longitude,\n                latitudeDelta: 0.0922,\n                longitudeDelta: 0.0421\n              });\n              return;\n            }\n          } catch (lastLocError) {\n            console.error('Error al obtener Ãºltima ubicaciÃ³n conocida:', lastLocError);\n          }\n          setErrorLocationMsg(`No se pudo obtener tu ubicaciÃ³n. Usando ubicaciÃ³n por defecto.`);\n        }\n      } catch (error) {\n        console.error('Error al obtener la ubicaciÃ³n:', error);\n        setErrorLocationMsg(`Error al obtener la ubicaciÃ³n: ${error.message}. Usando ubicaciÃ³n por defecto.`);\n      }\n    });\n    return function getLocation() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var calculateDuration = function calculateDuration(start, end) {\n    if (!start || !end) return 0;\n    var diffTime = Math.abs(end.getTime() - start.getTime());\n    var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    return diffDays;\n  };\n  var handleCitySearch = function () {\n    var _ref5 = _asyncToGenerator(function* (text) {\n      var upperText = text.toUpperCase();\n      setSearchCity(upperText);\n      if (text.length > 2) {\n        try {\n          var cities = yield searchCities(upperText);\n          setFilteredCities(cities);\n          setShowSuggestions(true);\n        } catch (error) {\n          console.error('Error searching cities:', error);\n          setFilteredCities([]);\n        }\n      } else {\n        setFilteredCities([]);\n        setShowSuggestions(false);\n      }\n    });\n    return function handleCitySearch(_x) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var handleCitySelect = function handleCitySelect(city) {\n    setSearchCity(city.name.toUpperCase());\n    setShowSuggestions(false);\n    setRegion({\n      latitude: city.latitude,\n      longitude: city.longitude,\n      latitudeDelta: 0.0922,\n      longitudeDelta: 0.0421\n    });\n  };\n  var handleSearch = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      if (!(user != null && user.id)) {\n        setErrorMsg('Debes iniciar sesiÃ³n para generar misiones');\n        return;\n      }\n      var missionCountNum = parseInt(missionCount) || 3;\n      if (!duration || duration <= 0) {\n        setErrorMsg('Por favor, selecciona fechas vÃ¡lidas para crear un viaje');\n        return;\n      }\n      if (!startDate || !endDate) {\n        setErrorMsg('Selecciona fechas de inicio y fin');\n        return;\n      }\n      if (!searchCity) {\n        setErrorMsg('Por favor, ingresa una ciudad de destino');\n        return;\n      }\n      try {\n        var validStartDate = new Date(startDate.getTime());\n        var validEndDate = new Date(endDate.getTime());\n        if (validEndDate < validStartDate) {\n          setErrorMsg('La fecha de fin no puede ser anterior a la fecha de inicio');\n          return;\n        }\n        setIsLoading(true);\n        setErrorMsg(null);\n        setCurrentStep(`Preparando tu viaje a ${searchCity}...`);\n        yield new Promise(function (resolve) {\n          return setTimeout(resolve, 1500);\n        });\n        setCurrentStep(`Buscando lugares interesantes en ${searchCity}...`);\n        yield new Promise(function (resolve) {\n          return setTimeout(resolve, 2000);\n        });\n        setCurrentStep(`Creando ${missionCountNum} misiones emocionantes...`);\n        var selectedCity = filteredCities.find(function (city) {\n          return city.name.toUpperCase() === searchCity;\n        });\n        var cityName = selectedCity ? selectedCity.name : searchCity;\n        var result = yield generateMission(cityName, duration, missionCountNum, user.id, validStartDate, validEndDate, selectedTags);\n        if (!result.journeyId) {\n          throw new Error('No se recibiÃ³ el ID del journey');\n        }\n        setCurrentStep('Â¡Aventura generada con Ã©xito!');\n        yield new Promise(function (resolve) {\n          return setTimeout(resolve, 1000);\n        });\n        navigation.navigate('Missions', {\n          journeyId: result.journeyId,\n          challenges: result.challenges || []\n        });\n      } catch (error) {\n        console.error('Error generando misiones:', error);\n        setErrorMsg('Error al generar las misiones. Por favor, intenta de nuevo.');\n      } finally {\n        setIsLoading(false);\n        setCurrentStep('');\n      }\n    });\n    return function handleSearch() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var onDatesChange = function onDatesChange(dates) {\n    var _dates = _slicedToArray(dates, 2),\n      start = _dates[0],\n      end = _dates[1];\n    console.log('MapScreen - Fechas seleccionadas:', {\n      start: start,\n      end: end\n    });\n    setStartDate(start);\n    setEndDate(end);\n    if (start && end) {\n      var diffTime = Math.abs(end.getTime() - start.getTime());\n      var newDuration = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n      console.log('Nueva duraciÃ³n calculada:', newDuration);\n      setDuration(newDuration);\n    } else {\n      setDuration(0);\n    }\n  };\n  var DateRangePicker = Platform.OS === 'web' ? DateRangePickerWeb : DateRangePickerMobile;\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsxs(View, {\n      style: styles.searchContainer,\n      children: [_jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"Buscar ciudad\",\n        value: searchCity,\n        onChangeText: handleCitySearch\n      }), showSuggestions && filteredCities.length > 0 && _jsx(View, {\n        style: styles.suggestionsList,\n        children: filteredCities.map(function (city) {\n          return _jsx(TouchableOpacity, {\n            style: styles.suggestionItem,\n            onPress: function onPress() {\n              return handleCitySelect(city);\n            },\n            children: _jsx(Text, {\n              style: styles.suggestionText,\n              children: city.name\n            })\n          }, city.id);\n        })\n      }), _jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"N\\xFAmero de misiones\",\n        value: missionCount,\n        onChangeText: setMissionCount,\n        keyboardType: \"numeric\"\n      }), _jsx(DateRangePicker, {\n        startDateProp: startDate,\n        endDateProp: endDate,\n        onDatesChange: onDatesChange\n      }), _jsxs(Text, {\n        style: styles.durationText,\n        children: [\"Duraci\\xF3n del viaje: \", calculateDuration(startDate, endDate), \" d\\xEDas\"]\n      }), _jsx(Text, {\n        style: styles.tagsTitle,\n        children: \"Preferencias de viaje:\"\n      }), _jsx(View, {\n        style: styles.tagsContainer,\n        children: availableTags.map(function (tag) {\n          return _jsx(TouchableOpacity, {\n            style: [styles.tagButton, selectedTags.includes(tag.id) && styles.tagButtonSelected],\n            onPress: function onPress() {\n              return toggleTag(tag.id);\n            },\n            children: _jsx(Text, {\n              style: [styles.tagText, selectedTags.includes(tag.id) && styles.tagTextSelected],\n              children: tag.label\n            })\n          }, tag.id);\n        })\n      }), _jsx(TouchableOpacity, {\n        style: [styles.button, isLoading && styles.buttonDisabled],\n        onPress: handleSearch,\n        disabled: isLoading,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: isLoading ? 'Generando...' : 'Buscar Aventuras'\n        })\n      }), errorMsg ? _jsx(Text, {\n        style: styles.errorText,\n        children: errorMsg\n      }) : null]\n    }), _jsx(View, {\n      style: styles.mapContainer,\n      children: errorLocationMsg ? _jsx(View, {\n        style: styles.errorContainer,\n        children: _jsx(Text, {\n          style: styles.errorText,\n          children: errorLocationMsg\n        })\n      }) : _jsx(SimpleWebView, {\n        style: styles.map\n      })\n    }), _jsx(LoadingModal, {\n      visible: isLoading,\n      currentStep: currentStep\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5'\n  },\n  searchContainer: {\n    backgroundColor: 'white',\n    padding: 15,\n    borderBottomLeftRadius: 20,\n    borderBottomRightRadius: 20,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n    zIndex: 9999,\n    position: 'relative'\n  },\n  mapContainer: {\n    flex: 1,\n    marginTop: 10\n  },\n  map: {\n    width: '100%',\n    height: '100%'\n  },\n  input: {\n    height: 40,\n    borderColor: '#ddd',\n    borderWidth: 1,\n    borderRadius: 5,\n    marginBottom: 10,\n    paddingHorizontal: 10,\n    backgroundColor: 'white'\n  },\n  button: {\n    backgroundColor: '#005F9E',\n    padding: 15,\n    borderRadius: 10,\n    alignItems: 'center',\n    marginTop: 10\n  },\n  buttonDisabled: {\n    backgroundColor: '#78909C'\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: 'bold'\n  },\n  errorText: {\n    color: '#D32F2F',\n    marginTop: 10\n  },\n  modalContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)'\n  },\n  loadingCard: {\n    backgroundColor: 'white',\n    padding: 20,\n    borderRadius: 15,\n    alignItems: 'center',\n    width: '80%',\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5\n  },\n  loadingTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#333',\n    marginTop: 15,\n    marginBottom: 10\n  },\n  loadingStep: {\n    fontSize: 16,\n    color: '#666',\n    textAlign: 'center',\n    marginTop: 10\n  },\n  datePickersRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 10,\n    backgroundColor: 'white',\n    borderRadius: 8,\n    padding: 15,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 3.84,\n    elevation: 2\n  },\n  datePickerContainer: _objectSpread({\n    position: 'relative',\n    zIndex: 9999,\n    backgroundColor: 'white',\n    borderRadius: 8,\n    padding: 8,\n    marginBottom: 16,\n    overflow: 'visible'\n  }, Platform.select({\n    web: {\n      boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\n    },\n    default: {\n      elevation: 2,\n      shadowColor: '#000',\n      shadowOffset: {\n        width: 0,\n        height: 2\n      },\n      shadowOpacity: 0.1,\n      shadowRadius: 4\n    }\n  })),\n  datePickerButton: {\n    backgroundColor: '#005F9E',\n    borderRadius: 8,\n    padding: 12\n  },\n  datePickerContent: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  datePickerText: {\n    color: 'white',\n    fontSize: 16\n  },\n  calendarDropdown: {\n    backgroundColor: 'white',\n    borderRadius: 8,\n    padding: 15,\n    marginTop: 8,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 10,\n    elevation: 5\n  },\n  durationText: {\n    textAlign: 'center',\n    marginBottom: 10,\n    color: '#666'\n  },\n  dateRangeContainer: {\n    backgroundColor: 'white',\n    borderRadius: 8,\n    padding: 15,\n    marginBottom: 15,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 3.84,\n    elevation: 2\n  },\n  suggestionsList: {\n    position: 'absolute',\n    top: '100%',\n    left: 0,\n    right: 0,\n    backgroundColor: 'white',\n    borderRadius: 5,\n    maxHeight: 200,\n    zIndex: 2,\n    elevation: 5,\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84\n  },\n  suggestionItem: {\n    padding: 15,\n    borderBottomWidth: 1,\n    borderBottomColor: '#eee'\n  },\n  suggestionText: {\n    fontSize: 16,\n    color: '#333'\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  loadingText: {\n    marginTop: 10,\n    color: '#666'\n  },\n  retryButton: {\n    backgroundColor: '#4CAF50',\n    padding: 10,\n    borderRadius: 5,\n    marginTop: 10\n  },\n  retryButtonText: {\n    color: 'white',\n    textAlign: 'center',\n    fontWeight: 'bold'\n  },\n  errorOverlay: {\n    position: 'absolute',\n    top: 10,\n    left: 10,\n    right: 10,\n    backgroundColor: 'rgba(244, 67, 54, 0.9)',\n    padding: 10,\n    borderRadius: 5\n  },\n  progressBar: {\n    height: 8,\n    width: '100%',\n    backgroundColor: '#f0f0f0',\n    borderRadius: 10,\n    overflow: 'hidden',\n    marginTop: 20,\n    marginBottom: 10\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: '#4CAF50',\n    borderRadius: 10\n  },\n  tagsTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginTop: 10,\n    marginBottom: 8\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    marginBottom: 15\n  },\n  tagButton: {\n    borderWidth: 1,\n    borderColor: '#005F9E',\n    borderRadius: 15,\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    margin: 4,\n    backgroundColor: 'white'\n  },\n  tagButtonSelected: {\n    backgroundColor: '#005F9E'\n  },\n  tagText: {\n    color: '#005F9E',\n    fontSize: 12\n  },\n  tagTextSelected: {\n    color: 'white'\n  },\n  errorContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20\n  }\n});\nexport default MapScreen;","map":{"version":3,"names":["React","useState","useEffect","View","StyleSheet","TextInput","TouchableOpacity","Text","Dimensions","Platform","Modal","ActivityIndicator","useDispatch","useSelector","Location","useNavigation","generateMission","Ionicons","Calendar","format","searchCities","SimpleWebView","jsx","_jsx","jsxs","_jsxs","_Dimensions$get","get","width","height","LoadingModal","_ref","visible","currentStep","transparent","animationType","children","style","styles","modalContainer","loadingCard","size","color","loadingTitle","loadingStep","progressBar","progressFill","includes","DateRangePickerMobile","_ref2","startDateProp","endDateProp","onDatesChange","_useState","_useState2","_slicedToArray","startDate","setStartDate","_useState3","_useState4","endDate","setEndDate","_useState5","_useState6","isOpen","setIsOpen","_useState7","_useState8","selectedDates","setSelectedDates","updateMarkedDates","start","end","newMarkedDates","startStr","startingDay","textColor","endStr","endingDay","currentDate","Date","setDate","getDate","dateStr","handleDayPress","day","selectedDate","dateString","newStart","newEnd","calculateDuration","diffTime","Math","abs","getTime","ceil","formatDateRange","formatDate","date","duration","datePickerContainer","datePickerButton","onPress","datePickerContent","datePickerText","name","calendarDropdown","minDate","toISOString","split","onDayPress","markingType","markedDates","theme","calendarBackground","textSectionTitleColor","selectedDayBackgroundColor","selectedDayTextColor","todayTextColor","dayTextColor","textDisabledColor","dotColor","selectedDotColor","arrowColor","monthTextColor","indicatorColor","DateRangePickerWeb","_ref3","_useState9","_useState10","_useState11","_useState12","_useState13","_useState14","_useState15","_useState16","currentMonth","setCurrentMonth","generateCalendar","year","getFullYear","month","getMonth","firstDay","startingDayOfWeek","getDay","lastDay","totalDays","days","i","prevMonthDay","unshift","isCurrentMonth","isToday","isSelected","today","setHours","isStartDate","isEndDate","isInRange","push","remainingDays","length","nextMonthDay","handleDateClick","formatMonth","months","changeMonth","offset","newMonth","setMonth","weekDays","position","top","left","right","backgroundColor","zIndex","boxShadow","borderRadius","marginTop","padding","marginLeft","marginRight","display","justifyContent","marginBottom","flexDirection","alignItems","onClick","background","border","fontSize","cursor","margin","gridTemplateColumns","gap","textAlign","map","fontWeight","index","opacity","MapScreen","navigation","dispatch","_useSelector","state","auth","user","_useState17","latitude","longitude","latitudeDelta","longitudeDelta","_useState18","region","setRegion","_useState19","_useState20","searchCity","setSearchCity","_useState21","_useState22","missionCount","setMissionCount","_useState23","_useState24","_useState25","_useState26","_useState27","_useState28","showStartDatePicker","setShowStartDatePicker","_useState29","_useState30","showEndDatePicker","setShowEndDatePicker","_useState31","_useState32","errorMsg","setErrorMsg","_useState33","_useState34","isLoading","setIsLoading","_useState35","_useState36","setCurrentStep","_useState37","_useState38","hasLocationPermission","setHasLocationPermission","_useState39","_useState40","isLoadingLocation","setIsLoadingLocation","_useState41","_useState42","errorLocationMsg","setErrorLocationMsg","_useState43","_useState44","filteredCities","setFilteredCities","_useState45","_useState46","showSuggestions","setShowSuggestions","_useState47","_useState48","setDuration","_useState49","_useState50","userLocation","setUserLocation","_useState51","_useState52","selectedTags","setSelectedTags","availableTags","id","label","toggleTag","tagId","prevTags","filter","concat","_toConsumableArray","getLocation","_ref4","_asyncToGenerator","console","log","_yield$Location$reque","requestForegroundPermissionsAsync","status","warn","options","OS","accuracy","Accuracy","Balanced","timeInterval","distanceInterval","mayShowUserSettingsDialog","JSON","stringify","location","getCurrentPositionAsync","coords","locationError","error","lastLocation","getLastKnownPositionAsync","lastLocError","message","apply","arguments","diffDays","handleCitySearch","_ref5","text","upperText","toUpperCase","cities","_x","handleCitySelect","city","handleSearch","_ref6","missionCountNum","parseInt","validStartDate","validEndDate","Promise","resolve","setTimeout","selectedCity","find","cityName","result","journeyId","Error","navigate","challenges","dates","_dates","newDuration","DateRangePicker","container","searchContainer","input","placeholder","value","onChangeText","suggestionsList","suggestionItem","suggestionText","keyboardType","durationText","tagsTitle","tagsContainer","tag","tagButton","tagButtonSelected","tagText","tagTextSelected","button","buttonDisabled","disabled","buttonText","errorText","mapContainer","errorContainer","create","flex","borderBottomLeftRadius","borderBottomRightRadius","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","borderColor","borderWidth","paddingHorizontal","datePickersRow","_objectSpread","overflow","select","web","default","dateRangeContainer","maxHeight","borderBottomWidth","borderBottomColor","loadingContainer","loadingText","retryButton","retryButtonText","errorOverlay","flexWrap","paddingVertical"],"sources":["C:/Users/migue/TravelQuest/src/screens/main/MapScreen.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, StyleSheet, TextInput, TouchableOpacity, Text, Dimensions, Platform, Modal, ActivityIndicator } from 'react-native';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { RootState } from '../../features/store';\r\nimport Map from '../../components/maps';\r\nimport * as Location from 'expo-location';\r\nimport { getMissionsByCityAndDuration } from '../../services/missionService';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\r\nimport generateMission from '../../services/missionGenerator';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { Calendar } from 'react-native-calendars';\r\nimport { format } from 'date-fns';\r\nimport { searchCities } from '../../services/supabase';\r\nimport SimpleWebView from '../../components/SimpleWebView';\r\n\r\ninterface City {\r\n  id: string;\r\n  name: string;\r\n  latitude: number;\r\n  longitude: number;\r\n}\r\n\r\ntype RootStackParamList = {\r\n  Missions: {\r\n    journeyId: string;\r\n    challenges: any[];\r\n  };\r\n};\r\n\r\ntype NavigationProp = NativeStackNavigationProp<RootStackParamList>;\r\n\r\nconst { width, height } = Dimensions.get('window');\r\n\r\nconst LoadingModal = ({ visible, currentStep }: { visible: boolean; currentStep: string }) => (\r\n  <Modal\r\n    transparent={true}\r\n    visible={visible}\r\n    animationType=\"fade\"\r\n  >\r\n    <View style={styles.modalContainer}>\r\n      <View style={styles.loadingCard}>\r\n        <ActivityIndicator size=\"large\" color=\"#4CAF50\" />\r\n        <Text style={styles.loadingTitle}>Generando tu aventura</Text>\r\n        <Text style={styles.loadingStep}>{currentStep}</Text>\r\n        \r\n        {/* Indicador de progreso visual */}\r\n        <View style={styles.progressBar}>\r\n          <View style={[\r\n            styles.progressFill, \r\n            { \r\n              width: currentStep.includes('Preparando') ? '30%' : \r\n                    currentStep.includes('Buscando') ? '60%' : \r\n                    currentStep.includes('Creando') ? '90%' : '10%' \r\n            }\r\n          ]} />\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </Modal>\r\n);\r\n\r\nconst DateRangePickerMobile: React.FC<{\r\n  startDateProp: Date | null;\r\n  endDateProp: Date | null;\r\n  onDatesChange: (dates: [Date | null, Date | null]) => void;\r\n}> = ({ startDateProp, endDateProp, onDatesChange }) => {\r\n  const [startDate, setStartDate] = useState<Date | null>(startDateProp);\r\n  const [endDate, setEndDate] = useState<Date | null>(endDateProp);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [selectedDates, setSelectedDates] = useState<{[date: string]: any}>({});\r\n\r\n  useEffect(() => {\r\n    setStartDate(startDateProp);\r\n    setEndDate(endDateProp);\r\n    \r\n    if (startDateProp || endDateProp) {\r\n      updateMarkedDates(startDateProp, endDateProp);\r\n    }\r\n  }, [startDateProp, endDateProp]);\r\n\r\n  const updateMarkedDates = (start: Date | null, end: Date | null) => {\r\n    const newMarkedDates: {[date: string]: any} = {};\r\n    \r\n    if (start) {\r\n      const startStr = format(start, 'yyyy-MM-dd');\r\n      newMarkedDates[startStr] = { \r\n        startingDay: true, \r\n        color: '#005F9E',\r\n        textColor: 'white'\r\n      };\r\n    }\r\n    \r\n    if (end) {\r\n      const endStr = format(end, 'yyyy-MM-dd');\r\n      newMarkedDates[endStr] = { \r\n        endingDay: true, \r\n        color: '#005F9E',\r\n        textColor: 'white'\r\n      };\r\n    }\r\n    \r\n    if (start && end) {\r\n      let currentDate = new Date(start);\r\n      currentDate.setDate(currentDate.getDate() + 1);\r\n      \r\n      while (currentDate < end) {\r\n        const dateStr = format(currentDate, 'yyyy-MM-dd');\r\n        newMarkedDates[dateStr] = { \r\n          color: '#e5f3ff',\r\n          textColor: '#005F9E'\r\n        };\r\n        currentDate.setDate(currentDate.getDate() + 1);\r\n      }\r\n    }\r\n    \r\n    setSelectedDates(newMarkedDates);\r\n  };\r\n\r\n  const handleDayPress = (day: any) => {\r\n    const selectedDate = new Date(day.dateString);\r\n    \r\n    if (!startDate || (startDate && endDate)) {\r\n      const newStart = selectedDate;\r\n      setStartDate(newStart);\r\n      setEndDate(null);\r\n      updateMarkedDates(newStart, null);\r\n      onDatesChange([newStart, null]);\r\n    } else {\r\n      if (selectedDate < startDate) {\r\n        const newEnd = new Date(startDate);\r\n        setEndDate(newEnd);\r\n        setStartDate(selectedDate);\r\n        updateMarkedDates(selectedDate, newEnd);\r\n        onDatesChange([selectedDate, newEnd]);\r\n      } else {\r\n        setEndDate(selectedDate);\r\n        updateMarkedDates(startDate, selectedDate);\r\n        onDatesChange([startDate, selectedDate]);\r\n      }\r\n    }\r\n  };\r\n\r\n  const calculateDuration = (start: Date | null, end: Date | null): number => {\r\n    if (!start || !end) return 0;\r\n    const diffTime = Math.abs(end.getTime() - start.getTime());\r\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n  };\r\n\r\n  const formatDateRange = (): string => {\r\n    if (!startDate && !endDate) {\r\n      return 'Selecciona fechas';\r\n    }\r\n    \r\n    const formatDate = (date: Date | null): string => {\r\n      if (!date) return '';\r\n      return format(date, 'dd MMM');\r\n    };\r\n\r\n    const duration = calculateDuration(startDate, endDate);\r\n    const startStr = formatDate(startDate);\r\n    const endStr = formatDate(endDate);\r\n\r\n    if (startStr && endStr) {\r\n      return `${startStr} - ${endStr} Â· ${duration} noches`;\r\n    } else if (startStr) {\r\n      return `${startStr} - Selecciona fecha final`;\r\n    } else {\r\n      return 'Selecciona fechas';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.datePickerContainer}>\r\n      <TouchableOpacity\r\n        style={styles.datePickerButton}\r\n        onPress={() => setIsOpen(!isOpen)}\r\n      >\r\n        <View style={styles.datePickerContent}>\r\n          <Text style={styles.datePickerText}>{formatDateRange()}</Text>\r\n          <Ionicons name={isOpen ? 'chevron-up' : 'chevron-down'} size={24} color=\"white\" />\r\n        </View>\r\n      </TouchableOpacity>\r\n      {isOpen && (\r\n        <View style={styles.calendarDropdown}>\r\n          <Calendar\r\n            minDate={new Date().toISOString().split('T')[0]}\r\n            onDayPress={handleDayPress}\r\n            markingType=\"period\"\r\n            markedDates={selectedDates}\r\n            theme={{\r\n              calendarBackground: '#ffffff',\r\n              textSectionTitleColor: '#b6c1cd',\r\n              selectedDayBackgroundColor: '#005F9E',\r\n              selectedDayTextColor: '#ffffff',\r\n              todayTextColor: '#005F9E',\r\n              dayTextColor: '#2d4150',\r\n              textDisabledColor: '#d9e1e8',\r\n              dotColor: '#005F9E',\r\n              selectedDotColor: '#ffffff',\r\n              arrowColor: '#005F9E',\r\n              monthTextColor: '#005F9E',\r\n              indicatorColor: '#005F9E',\r\n            }}\r\n          />\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\n// En lugar de usar react-datepicker, crear un componente propio para web\r\nconst DateRangePickerWeb: React.FC<{\r\n  startDateProp: Date | null;\r\n  endDateProp: Date | null;\r\n  onDatesChange: (dates: [Date | null, Date | null]) => void;\r\n}> = ({ startDateProp, endDateProp, onDatesChange }) => {\r\n  const [startDate, setStartDate] = useState<Date | null>(startDateProp);\r\n  const [endDate, setEndDate] = useState<Date | null>(endDateProp);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [currentMonth, setCurrentMonth] = useState(new Date());\r\n  \r\n  useEffect(() => {\r\n    setStartDate(startDateProp);\r\n    setEndDate(endDateProp);\r\n  }, [startDateProp, endDateProp]);\r\n  \r\n  // FunciÃ³n para generar el calendario\r\n  const generateCalendar = (date: Date) => {\r\n    const year = date.getFullYear();\r\n    const month = date.getMonth();\r\n    \r\n    // Obtener el primer dÃ­a del mes\r\n    const firstDay = new Date(year, month, 1);\r\n    const startingDayOfWeek = firstDay.getDay(); // 0 = domingo\r\n    \r\n    // Obtener el Ãºltimo dÃ­a del mes\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    const totalDays = lastDay.getDate();\r\n    \r\n    // Crear un array para los dÃ­as del mes\r\n    const days = [];\r\n    \r\n    // Agregar dÃ­as del mes anterior para completar la primera semana\r\n    for (let i = 0; i < startingDayOfWeek; i++) {\r\n      const prevMonthDay = new Date(year, month, -i);\r\n      days.unshift({\r\n        date: prevMonthDay,\r\n        isCurrentMonth: false,\r\n        isToday: false,\r\n        isSelected: false\r\n      });\r\n    }\r\n    \r\n    // Agregar los dÃ­as del mes actual\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    \r\n    for (let i = 1; i <= totalDays; i++) {\r\n      const currentDate = new Date(year, month, i);\r\n      currentDate.setHours(0, 0, 0, 0);\r\n      \r\n      const isToday = currentDate.getTime() === today.getTime();\r\n      const isStartDate = startDate && currentDate.getTime() === new Date(startDate).setHours(0,0,0,0);\r\n      const isEndDate = endDate && currentDate.getTime() === new Date(endDate).setHours(0,0,0,0);\r\n      const isInRange = startDate && endDate && \r\n                        currentDate.getTime() > new Date(startDate).setHours(0,0,0,0) && \r\n                        currentDate.getTime() < new Date(endDate).setHours(0,0,0,0);\r\n      \r\n      days.push({\r\n        date: currentDate,\r\n        isCurrentMonth: true,\r\n        isToday,\r\n        isSelected: isStartDate || isEndDate,\r\n        isStartDate,\r\n        isEndDate,\r\n        isInRange\r\n      });\r\n    }\r\n    \r\n    // Agregar dÃ­as del mes siguiente para completar la Ãºltima semana\r\n    const remainingDays = 7 - (days.length % 7);\r\n    if (remainingDays < 7) {\r\n      for (let i = 1; i <= remainingDays; i++) {\r\n        const nextMonthDay = new Date(year, month + 1, i);\r\n        days.push({\r\n          date: nextMonthDay,\r\n          isCurrentMonth: false,\r\n          isToday: false,\r\n          isSelected: false\r\n        });\r\n      }\r\n    }\r\n    \r\n    return days;\r\n  };\r\n  \r\n  const handleDateClick = (date: Date) => {\r\n    // No permitir seleccionar fechas en el pasado\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    \r\n    if (date < today) {\r\n      return;\r\n    }\r\n    \r\n    if (!startDate || (startDate && endDate)) {\r\n      // Si no hay fecha de inicio o ambas fechas estÃ¡n seleccionadas, establecer como nueva fecha de inicio\r\n      setStartDate(date);\r\n      setEndDate(null);\r\n      onDatesChange([date, null]);\r\n    } else {\r\n      // Si solo hay fecha de inicio, establecer como fecha de fin\r\n      if (date < startDate) {\r\n        // Si la fecha seleccionada es anterior a la fecha de inicio, intercambiarlas\r\n        setEndDate(new Date(startDate));\r\n        setStartDate(date);\r\n        onDatesChange([date, startDate]);\r\n      } else {\r\n        setEndDate(date);\r\n        onDatesChange([startDate, date]);\r\n      }\r\n    }\r\n  };\r\n  \r\n  const formatMonth = (date: Date) => {\r\n    const months = [\r\n      'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',\r\n      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'\r\n    ];\r\n    return `${months[date.getMonth()]} ${date.getFullYear()}`;\r\n  };\r\n  \r\n  const changeMonth = (offset: number) => {\r\n    const newMonth = new Date(currentMonth);\r\n    newMonth.setMonth(newMonth.getMonth() + offset);\r\n    setCurrentMonth(newMonth);\r\n  };\r\n  \r\n  const days = generateCalendar(currentMonth);\r\n  const weekDays = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];\r\n  \r\n  const calculateDuration = (start: Date | null, end: Date | null): number => {\r\n    if (!start || !end) return 0;\r\n    const diffTime = Math.abs(end.getTime() - start.getTime());\r\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n  };\r\n  \r\n  const formatDate = (date: Date | null): string => {\r\n    if (!date) return '';\r\n    return `${date.getDate()} ${['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic'][date.getMonth()]}`;\r\n  };\r\n  \r\n  const formatDateRange = (): string => {\r\n    if (!startDate && !endDate) {\r\n      return 'Selecciona fechas';\r\n    }\r\n    \r\n    const startStr = formatDate(startDate);\r\n    const endStr = formatDate(endDate);\r\n    const duration = calculateDuration(startDate, endDate);\r\n    \r\n    if (startStr && endStr) {\r\n      return `${startStr} - ${endStr} Â· ${duration} noches`;\r\n    } else if (startStr) {\r\n      return `${startStr} - Selecciona fecha final`;\r\n    } else {\r\n      return 'Selecciona fechas';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.datePickerContainer}>\r\n      <TouchableOpacity\r\n        style={styles.datePickerButton}\r\n        onPress={() => setIsOpen(!isOpen)}\r\n      >\r\n        <View style={styles.datePickerContent}>\r\n          <Text style={styles.datePickerText}>{formatDateRange()}</Text>\r\n          <Ionicons name={isOpen ? 'chevron-up' : 'chevron-down'} size={24} color=\"white\" />\r\n        </View>\r\n      </TouchableOpacity>\r\n      \r\n      {isOpen && (\r\n    <div style={{ \r\n          position: 'absolute',\r\n          top: '100%',\r\n          left: 0,\r\n          right: 0,\r\n          backgroundColor: 'white',\r\n          zIndex: 9999,\r\n          boxShadow: '0px 2px 10px rgba(0,0,0,0.1)',\r\n          borderRadius: 8,\r\n          marginTop: 4,\r\n          padding: 15,\r\n          width: 620,\r\n          marginLeft: 'auto',\r\n          marginRight: 'auto'\r\n        }}>\r\n          <div style={{\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            marginBottom: 10\r\n          }}>\r\n            <div style={{\r\n              display: 'flex',\r\n              flexDirection: 'row',\r\n              alignItems: 'center'\r\n    }}>\r\n      <button\r\n                onClick={() => changeMonth(-1)}\r\n        style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  fontSize: 24,\r\n                  cursor: 'pointer',\r\n                  color: '#005F9E'\r\n                }}\r\n              >\r\n                &larr;\r\n      </button>\r\n              <h3 style={{\r\n                margin: '0 15px',\r\n                color: '#005F9E'\r\n              }}>\r\n                {formatMonth(currentMonth)}\r\n              </h3>\r\n              <button \r\n                onClick={() => changeMonth(1)}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  fontSize: 24,\r\n                  cursor: 'pointer',\r\n                  color: '#005F9E'\r\n                }}\r\n              >\r\n                &rarr;\r\n              </button>\r\n            </div>\r\n            \r\n            <div style={{\r\n              display: 'flex',\r\n              alignItems: 'center'\r\n            }}>\r\n              <button \r\n                onClick={() => {\r\n                  setStartDate(null);\r\n                  setEndDate(null);\r\n                  onDatesChange([null, null]);\r\n                }}\r\n                style={{\r\n                  background: 'none',\r\n                  border: '1px solid #ddd',\r\n                  padding: '5px 10px',\r\n                  borderRadius: 4,\r\n                  cursor: 'pointer'\r\n                }}\r\n              >\r\n                Limpiar\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: 'repeat(7, 1fr)',\r\n            gap: 5,\r\n            textAlign: 'center'\r\n          }}>\r\n            {weekDays.map(day => (\r\n              <div key={day} style={{\r\n                padding: 5,\r\n                fontWeight: 'bold',\r\n                color: '#666'\r\n              }}>\r\n                {day}\r\n              </div>\r\n            ))}\r\n            \r\n            {days.map((day, index) => (\r\n              <div \r\n                key={index}\r\n                onClick={() => day.isCurrentMonth && handleDateClick(day.date)}\r\n          style={{\r\n                  padding: 10,\r\n                  cursor: day.isCurrentMonth ? 'pointer' : 'default',\r\n                  backgroundColor: day.isStartDate || day.isEndDate \r\n                    ? '#005F9E' \r\n                    : day.isInRange \r\n                      ? '#e5f3ff' \r\n                      : 'transparent',\r\n                  color: day.isStartDate || day.isEndDate \r\n                    ? 'white' \r\n                    : !day.isCurrentMonth \r\n                      ? '#ccc' \r\n                      : day.isToday \r\n                        ? '#005F9E' \r\n                        : '#333',\r\n                  fontWeight: day.isToday ? 'bold' : 'normal',\r\n                  borderRadius: 4,\r\n                  opacity: day.isCurrentMonth ? 1 : 0.5\r\n                }}\r\n              >\r\n                {day.date.getDate()}\r\n        </div>\r\n            ))}\r\n    </div>\r\n        </div>\r\n      )}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst MapScreen = () => {\r\n  const navigation = useNavigation<NavigationProp>();\r\n  const dispatch = useDispatch();\r\n  const { user } = useSelector((state: RootState) => state.auth);\r\n  const [region, setRegion] = useState({\r\n    latitude: 40.416775, // Madrid por defecto\r\n    longitude: -3.703790,\r\n    latitudeDelta: 0.0922,\r\n    longitudeDelta: 0.0421,\r\n  });\r\n  const [searchCity, setSearchCity] = useState('');\r\n  const [missionCount, setMissionCount] = useState('');\r\n  const [startDate, setStartDate] = useState<Date | null>(null);\r\n  const [endDate, setEndDate] = useState<Date | null>(null);\r\n  const [showStartDatePicker, setShowStartDatePicker] = useState(false);\r\n  const [showEndDatePicker, setShowEndDatePicker] = useState(false);\r\n  const [errorMsg, setErrorMsg] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [currentStep, setCurrentStep] = useState('');\r\n  const [hasLocationPermission, setHasLocationPermission] = useState(false);\r\n  const [isLoadingLocation, setIsLoadingLocation] = useState(false); // Cambiado a false para mostrar el mapa inmediatamente\r\n  const [errorLocationMsg, setErrorLocationMsg] = useState<string | null>(null);\r\n  const [filteredCities, setFilteredCities] = useState<City[]>([]);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [duration, setDuration] = useState<number>(0);\r\n  const [userLocation, setUserLocation] = useState<{ latitude: number; longitude: number } | null>({\r\n    latitude: 40.416775, // Madrid por defecto\r\n    longitude: -3.703790,\r\n  });\r\n  // AÃ±adir estado para los tags\r\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\r\n\r\n  // Definir los tags disponibles\r\n  const availableTags = [\r\n    { id: 'gratis', label: 'Gratuito' },\r\n    { id: 'naturaleza', label: 'Naturaleza' },\r\n    { id: 'arquitectura', label: 'Arquitectura' },\r\n    { id: 'arte', label: 'Arte' },\r\n    { id: 'cultura', label: 'Cultura' },\r\n    { id: 'gastronomia', label: 'GastronomÃ­a' },\r\n    { id: 'historia', label: 'Historia' },\r\n    { id: 'deportes', label: 'Deportes' },\r\n    { id: 'compras', label: 'Compras' },\r\n    { id: 'familia', label: 'Familiar' },\r\n  ];\r\n\r\n  // FunciÃ³n para seleccionar o deseleccionar un tag\r\n  const toggleTag = (tagId: string) => {\r\n    setSelectedTags(prevTags => \r\n      prevTags.includes(tagId)\r\n        ? prevTags.filter(id => id !== tagId)\r\n        : [...prevTags, tagId]\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Iniciar la obtenciÃ³n de la ubicaciÃ³n en segundo plano\r\n    getLocation();\r\n  }, []);\r\n\r\n  const getLocation = async () => {\r\n    try {\r\n      console.log('Solicitando permisos de ubicaciÃ³n en segundo plano...');\r\n      let { status } = await Location.requestForegroundPermissionsAsync();\r\n      console.log('Estado de permisos de ubicaciÃ³n:', status);\r\n      \r\n      if (status !== 'granted') {\r\n        console.warn('Permiso de ubicaciÃ³n denegado');\r\n        setErrorLocationMsg('Permiso de ubicaciÃ³n denegado. Usando ubicaciÃ³n por defecto.');\r\n        return;\r\n      }\r\n\r\n      console.log('Permisos concedidos, obteniendo ubicaciÃ³n actual...');\r\n      \r\n      // Configurar opciones para obtener la ubicaciÃ³n\r\n      const options = Platform.OS === 'android' ? {\r\n        accuracy: Location.Accuracy.Balanced,\r\n        timeInterval: 10000,\r\n        distanceInterval: 10,\r\n        mayShowUserSettingsDialog: true,\r\n      } : {\r\n        accuracy: Location.Accuracy.Balanced\r\n      };\r\n      \r\n      console.log('Usando opciones de ubicaciÃ³n:', JSON.stringify(options));\r\n      \r\n      try {\r\n        console.log('Intentando obtener ubicaciÃ³n...');\r\n        let location = await Location.getCurrentPositionAsync(options);\r\n        console.log('UbicaciÃ³n obtenida:', JSON.stringify(location.coords));\r\n        \r\n        // Actualizar estado con la ubicaciÃ³n obtenida\r\n        setUserLocation({\r\n          latitude: location.coords.latitude,\r\n          longitude: location.coords.longitude,\r\n        });\r\n        \r\n        // Actualizar el estado de la regiÃ³n del mapa\r\n        setRegion({\r\n          latitude: location.coords.latitude,\r\n          longitude: location.coords.longitude,\r\n          latitudeDelta: 0.0922,\r\n          longitudeDelta: 0.0421,\r\n        });\r\n      } catch (locationError: any) {\r\n        console.error('Error especÃ­fico al obtener ubicaciÃ³n:', locationError);\r\n        \r\n        // Intentar con el mÃ©todo getLastKnownPositionAsync como fallback\r\n        console.log('Intentando obtener Ãºltima ubicaciÃ³n conocida...');\r\n        try {\r\n          const lastLocation = await Location.getLastKnownPositionAsync();\r\n          if (lastLocation) {\r\n            console.log('Ãltima ubicaciÃ³n conocida:', JSON.stringify(lastLocation.coords));\r\n            setUserLocation({\r\n              latitude: lastLocation.coords.latitude,\r\n              longitude: lastLocation.coords.longitude,\r\n            });\r\n            \r\n            setRegion({\r\n              latitude: lastLocation.coords.latitude,\r\n              longitude: lastLocation.coords.longitude,\r\n              latitudeDelta: 0.0922,\r\n              longitudeDelta: 0.0421,\r\n            });\r\n            return;\r\n          }\r\n        } catch (lastLocError) {\r\n          console.error('Error al obtener Ãºltima ubicaciÃ³n conocida:', lastLocError);\r\n        }\r\n        \r\n        // No lanzamos error, simplemente dejamos la ubicaciÃ³n por defecto\r\n        setErrorLocationMsg(`No se pudo obtener tu ubicaciÃ³n. Usando ubicaciÃ³n por defecto.`);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error al obtener la ubicaciÃ³n:', error);\r\n      setErrorLocationMsg(`Error al obtener la ubicaciÃ³n: ${error.message}. Usando ubicaciÃ³n por defecto.`);\r\n    }\r\n  };\r\n\r\n  const calculateDuration = (start: Date | null, end: Date | null) => {\r\n    if (!start || !end) return 0;\r\n    const diffTime = Math.abs(end.getTime() - start.getTime());\r\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n    return diffDays;\r\n  };\r\n\r\n  const handleCitySearch = async (text: string) => {\r\n    const upperText = text.toUpperCase();\r\n    setSearchCity(upperText);\r\n    \r\n    if (text.length > 2) {\r\n      try {\r\n        const cities = await searchCities(upperText);\r\n        setFilteredCities(cities);\r\n        setShowSuggestions(true);\r\n      } catch (error) {\r\n        console.error('Error searching cities:', error);\r\n        setFilteredCities([]);\r\n      }\r\n    } else {\r\n      setFilteredCities([]);\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  const handleCitySelect = (city: City) => {\r\n    setSearchCity(city.name.toUpperCase());\r\n    setShowSuggestions(false);\r\n    setRegion({\r\n      latitude: city.latitude,\r\n      longitude: city.longitude,\r\n      latitudeDelta: 0.0922,\r\n      longitudeDelta: 0.0421,\r\n    });\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    if (!user?.id) {\r\n      setErrorMsg('Debes iniciar sesiÃ³n para generar misiones');\r\n      return;\r\n    }\r\n\r\n    const missionCountNum = parseInt(missionCount) || 3; // Usar 3 como valor por defecto si no hay nÃºmero\r\n\r\n    if (!duration || duration <= 0) {\r\n      setErrorMsg('Por favor, selecciona fechas vÃ¡lidas para crear un viaje');\r\n      return;\r\n    }\r\n\r\n    if (!startDate || !endDate) {\r\n      setErrorMsg('Selecciona fechas de inicio y fin');\r\n      return;\r\n    }\r\n\r\n    if (!searchCity) {\r\n      setErrorMsg('Por favor, ingresa una ciudad de destino');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const validStartDate = new Date(startDate.getTime());\r\n      const validEndDate = new Date(endDate.getTime());\r\n\r\n      if (validEndDate < validStartDate) {\r\n        setErrorMsg('La fecha de fin no puede ser anterior a la fecha de inicio');\r\n        return;\r\n      }\r\n\r\n      // Iniciar el proceso de generaciÃ³n\r\n      setIsLoading(true);\r\n      setErrorMsg(null);\r\n\r\n      // Paso 1: Preparando el viaje\r\n      setCurrentStep(`Preparando tu viaje a ${searchCity}...`);\r\n      await new Promise(resolve => setTimeout(resolve, 1500));\r\n\r\n      // Paso 2: Buscando lugares\r\n      setCurrentStep(`Buscando lugares interesantes en ${searchCity}...`);\r\n      await new Promise(resolve => setTimeout(resolve, 2000));\r\n\r\n      // Paso 3: Creando misiones\r\n      setCurrentStep(`Creando ${missionCountNum} misiones emocionantes...`);\r\n      \r\n      // Obtener la ciudad seleccionada del filtro de ciudades\r\n      let selectedCity = filteredCities.find(city => city.name.toUpperCase() === searchCity);\r\n      \r\n      // Si no se encuentra una coincidencia exacta, usar la ciudad escrita por el usuario\r\n      const cityName = selectedCity ? selectedCity.name : searchCity;\r\n      \r\n      // Llamar a la API para generar las misiones con el nombre real de la ciudad\r\n      const result = await generateMission(\r\n        cityName,\r\n        duration,\r\n        missionCountNum,\r\n        user.id,\r\n        validStartDate,\r\n        validEndDate,\r\n        selectedTags // Pasar los tags seleccionados\r\n      );\r\n      \r\n      if (!result.journeyId) {\r\n        throw new Error('No se recibiÃ³ el ID del journey');\r\n      }\r\n\r\n      // Paso final: Completado\r\n      setCurrentStep('Â¡Aventura generada con Ã©xito!');\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      // Navegar a la pantalla de misiones\r\n      navigation.navigate('Missions', {\r\n        journeyId: result.journeyId,\r\n        challenges: result.challenges || []\r\n      });\r\n    } catch (error) {\r\n      console.error('Error generando misiones:', error);\r\n      setErrorMsg('Error al generar las misiones. Por favor, intenta de nuevo.');\r\n    } finally {\r\n      setIsLoading(false);\r\n      setCurrentStep('');\r\n    }\r\n  };\r\n\r\n  const onDatesChange = (dates: [Date | null, Date | null]) => {\r\n    const [start, end] = dates;\r\n    \r\n    console.log('MapScreen - Fechas seleccionadas:', { start, end });\r\n    \r\n    setStartDate(start);\r\n    setEndDate(end);\r\n    \r\n    if (start && end) {\r\n      const diffTime = Math.abs(end.getTime() - start.getTime());\r\n      const newDuration = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n      console.log('Nueva duraciÃ³n calculada:', newDuration);\r\n      setDuration(newDuration);\r\n    } else {\r\n      setDuration(0);\r\n    }\r\n  };\r\n\r\n  // Elegir el componente correcto segÃºn la plataforma\r\n  const DateRangePicker = Platform.OS === 'web' ? DateRangePickerWeb : DateRangePickerMobile;\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.searchContainer}>\r\n          <TextInput\r\n            style={styles.input}\r\n            placeholder=\"Buscar ciudad\"\r\n            value={searchCity}\r\n            onChangeText={handleCitySearch}\r\n          />\r\n          {showSuggestions && filteredCities.length > 0 && (\r\n          <View style={styles.suggestionsList}>\r\n            {filteredCities.map((city) => (\r\n                <TouchableOpacity\r\n                key={city.id}\r\n                  style={styles.suggestionItem}\r\n                onPress={() => handleCitySelect(city)}\r\n                >\r\n                <Text style={styles.suggestionText}>{city.name}</Text>\r\n                </TouchableOpacity>\r\n            ))}\r\n        </View>\r\n        )}\r\n        <TextInput\r\n          style={styles.input}\r\n          placeholder=\"NÃºmero de misiones\"\r\n          value={missionCount}\r\n          onChangeText={setMissionCount}\r\n          keyboardType=\"numeric\"\r\n        />\r\n        \r\n        <DateRangePicker\r\n          startDateProp={startDate}\r\n          endDateProp={endDate}\r\n          onDatesChange={onDatesChange}\r\n        />\r\n\r\n        <Text style={styles.durationText}>\r\n          DuraciÃ³n del viaje: {calculateDuration(startDate, endDate)} dÃ­as\r\n        </Text>\r\n\r\n        {/* SecciÃ³n de etiquetas */}\r\n        <Text style={styles.tagsTitle}>Preferencias de viaje:</Text>\r\n        <View style={styles.tagsContainer}>\r\n          {availableTags.map(tag => (\r\n            <TouchableOpacity\r\n              key={tag.id}\r\n              style={[\r\n                styles.tagButton,\r\n                selectedTags.includes(tag.id) && styles.tagButtonSelected\r\n              ]}\r\n              onPress={() => toggleTag(tag.id)}\r\n            >\r\n              <Text\r\n                style={[\r\n                  styles.tagText,\r\n                  selectedTags.includes(tag.id) && styles.tagTextSelected\r\n                ]}\r\n              >\r\n                {tag.label}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          ))}\r\n        </View>\r\n\r\n        <TouchableOpacity\r\n          style={[styles.button, isLoading && styles.buttonDisabled]}\r\n          onPress={handleSearch}\r\n          disabled={isLoading}\r\n        >\r\n          <Text style={styles.buttonText}>\r\n            {isLoading ? 'Generando...' : 'Buscar Aventuras'}\r\n          </Text>\r\n        </TouchableOpacity>\r\n\r\n        {errorMsg ? <Text style={styles.errorText}>{errorMsg}</Text> : null}\r\n      </View>\r\n\r\n      <View style={styles.mapContainer}>\r\n        {errorLocationMsg ? (\r\n          <View style={styles.errorContainer}>\r\n            <Text style={styles.errorText}>{errorLocationMsg}</Text>\r\n          </View>\r\n        ) : (\r\n          <SimpleWebView style={styles.map} />\r\n        )}\r\n      </View>\r\n\r\n      <LoadingModal visible={isLoading} currentStep={currentStep} />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#f5f5f5',\r\n  },\r\n  searchContainer: {\r\n    backgroundColor: 'white',\r\n    padding: 15,\r\n    borderBottomLeftRadius: 20,\r\n    borderBottomRightRadius: 20,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n    zIndex: 9999,\r\n    position: 'relative',\r\n  },\r\n  mapContainer: {\r\n    flex: 1,\r\n    marginTop: 10,\r\n  },\r\n  map: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  input: {\r\n    height: 40,\r\n    borderColor: '#ddd',\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n    marginBottom: 10,\r\n    paddingHorizontal: 10,\r\n    backgroundColor: 'white',\r\n  },\r\n  button: {\r\n    backgroundColor: '#005F9E',\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  buttonDisabled: {\r\n    backgroundColor: '#78909C',\r\n  },\r\n  buttonText: {\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n  },\r\n  errorText: {\r\n    color: '#D32F2F',\r\n    marginTop: 10,\r\n  },\r\n  modalContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n  },\r\n  loadingCard: {\r\n    backgroundColor: 'white',\r\n    padding: 20,\r\n    borderRadius: 15,\r\n    alignItems: 'center',\r\n    width: '80%',\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n    elevation: 5,\r\n  },\r\n  loadingTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    color: '#333',\r\n    marginTop: 15,\r\n    marginBottom: 10,\r\n  },\r\n  loadingStep: {\r\n    fontSize: 16,\r\n    color: '#666',\r\n    textAlign: 'center',\r\n    marginTop: 10,\r\n  },\r\n  datePickersRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 10,\r\n    backgroundColor: 'white',\r\n    borderRadius: 8,\r\n    padding: 15,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3.84,\r\n    elevation: 2,\r\n  },\r\n  datePickerContainer: {\r\n    position: 'relative',\r\n    zIndex: 9999,\r\n    backgroundColor: 'white',\r\n    borderRadius: 8,\r\n    padding: 8,\r\n    marginBottom: 16,\r\n    overflow: 'visible',\r\n    ...Platform.select({\r\n      web: {\r\n        boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\r\n      },\r\n      default: {\r\n        elevation: 2,\r\n        shadowColor: '#000',\r\n        shadowOffset: { width: 0, height: 2 },\r\n        shadowOpacity: 0.1,\r\n        shadowRadius: 4\r\n      }\r\n    })\r\n  },\r\n  datePickerButton: {\r\n    backgroundColor: '#005F9E',\r\n    borderRadius: 8,\r\n    padding: 12,\r\n  },\r\n  datePickerContent: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  datePickerText: {\r\n    color: 'white',\r\n    fontSize: 16,\r\n  },\r\n  calendarDropdown: {\r\n    backgroundColor: 'white',\r\n    borderRadius: 8,\r\n    padding: 15,\r\n    marginTop: 8,\r\n    shadowColor: '#000',\r\n    shadowOffset: { width: 0, height: 2 },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 10,\r\n    elevation: 5,\r\n  },\r\n  durationText: {\r\n    textAlign: 'center',\r\n    marginBottom: 10,\r\n    color: '#666',\r\n  },\r\n  dateRangeContainer: {\r\n    backgroundColor: 'white',\r\n    borderRadius: 8,\r\n    padding: 15,\r\n    marginBottom: 15,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.1,\r\n    shadowRadius: 3.84,\r\n    elevation: 2,\r\n  },\r\n  suggestionsList: {\r\n    position: 'absolute',\r\n    top: '100%',\r\n    left: 0,\r\n    right: 0,\r\n    backgroundColor: 'white',\r\n    borderRadius: 5,\r\n    maxHeight: 200,\r\n    zIndex: 2,\r\n    elevation: 5,\r\n    shadowColor: '#000',\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 2,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3.84,\r\n  },\r\n  suggestionItem: {\r\n    padding: 15,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#eee',\r\n  },\r\n  suggestionText: {\r\n    fontSize: 16,\r\n    color: '#333',\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  loadingText: {\r\n    marginTop: 10,\r\n    color: '#666',\r\n  },\r\n  retryButton: {\r\n    backgroundColor: '#4CAF50',\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    marginTop: 10,\r\n  },\r\n  retryButtonText: {\r\n    color: 'white',\r\n    textAlign: 'center',\r\n    fontWeight: 'bold',\r\n  },\r\n  errorOverlay: {\r\n    position: 'absolute',\r\n    top: 10,\r\n    left: 10,\r\n    right: 10,\r\n    backgroundColor: 'rgba(244, 67, 54, 0.9)',\r\n    padding: 10,\r\n    borderRadius: 5,\r\n  },\r\n  progressBar: {\r\n    height: 8,\r\n    width: '100%',\r\n    backgroundColor: '#f0f0f0',\r\n    borderRadius: 10,\r\n    overflow: 'hidden',\r\n    marginTop: 20,\r\n    marginBottom: 10,\r\n  },\r\n  progressFill: {\r\n    height: '100%',\r\n    backgroundColor: '#4CAF50',\r\n    borderRadius: 10,\r\n  },\r\n  tagsTitle: {\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginTop: 10,\r\n    marginBottom: 8,\r\n  },\r\n  tagsContainer: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    marginBottom: 15,\r\n  },\r\n  tagButton: {\r\n    borderWidth: 1,\r\n    borderColor: '#005F9E',\r\n    borderRadius: 15,\r\n    paddingHorizontal: 12,\r\n    paddingVertical: 6,\r\n    margin: 4,\r\n    backgroundColor: 'white',\r\n  },\r\n  tagButtonSelected: {\r\n    backgroundColor: '#005F9E',\r\n  },\r\n  tagText: {\r\n    color: '#005F9E',\r\n    fontSize: 12,\r\n  },\r\n  tagTextSelected: {\r\n    color: 'white',\r\n  },\r\n  errorContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n});\r\n\r\nexport default MapScreen; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}