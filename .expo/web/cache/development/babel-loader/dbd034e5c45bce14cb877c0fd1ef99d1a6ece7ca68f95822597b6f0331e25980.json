{"ast":null,"code":"import { supabase } from './supabase';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { sendJourneySharedNotification } from './notificationTriggers';\nexport const shareJourney = async (journeyId, ownerId, friend) => {\n  if (!journeyId) {\n    Alert.alert('Error', 'No se pudo compartir el journey porque no se encontró el ID del viaje.');\n    return false;\n  }\n  try {\n    const {\n      data: journeyData,\n      error: journeyError\n    } = await supabase.from('journeys').select('description').eq('id', journeyId).single();\n    if (journeyError) throw journeyError;\n    const {\n      error\n    } = await supabase.from('journeys_shared').insert({\n      journeyId,\n      ownerId,\n      sharedWithUserId: friend.user2Id\n    });\n    if (error) throw error;\n    await sendJourneySharedNotification(friend.user2Id, friend.username, journeyData?.description || 'Un viaje');\n    Alert.alert('Éxito', `Journey compartido con ${friend.username}`);\n    return true;\n  } catch (err) {\n    console.error(err);\n    Alert.alert('Error', 'No se pudo compartir el journey');\n    return false;\n  }\n};","map":{"version":3,"names":["supabase","Alert","sendJourneySharedNotification","shareJourney","journeyId","ownerId","friend","alert","data","journeyData","error","journeyError","from","select","eq","single","insert","sharedWithUserId","user2Id","username","description","err","console"],"sources":["C:/Users/PC/TravelQuest/src/services/shareService.ts"],"sourcesContent":["import { supabase } from './supabase';\r\nimport { Alert } from 'react-native';\r\nimport { sendJourneySharedNotification } from './notificationTriggers';\r\n\r\ninterface Friend {\r\n    user2Id: string;\r\n    username: string;\r\n    points: number;\r\n}\r\n\r\nexport const shareJourney = async (\r\n    journeyId: string,\r\n    ownerId: string,\r\n    friend: Friend\r\n): Promise<boolean> => {\r\n    if (!journeyId) {\r\n        Alert.alert('Error', 'No se pudo compartir el journey porque no se encontró el ID del viaje.');\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        // Obtener el título del viaje\r\n        const { data: journeyData, error: journeyError } = await supabase\r\n            .from('journeys')\r\n            .select('description')\r\n            .eq('id', journeyId)\r\n            .single();\r\n\r\n        if (journeyError) throw journeyError;\r\n\r\n        // Compartir el viaje\r\n        const { error } = await supabase\r\n            .from('journeys_shared')\r\n            .insert({\r\n                journeyId,\r\n                ownerId,\r\n                sharedWithUserId: friend.user2Id\r\n            });\r\n\r\n        if (error) throw error;\r\n\r\n        // Enviar notificación al amigo\r\n        await sendJourneySharedNotification(\r\n            friend.user2Id,\r\n            friend.username,\r\n            journeyData?.description || 'Un viaje'\r\n        );\r\n\r\n        Alert.alert('Éxito', `Journey compartido con ${friend.username}`);\r\n        return true;\r\n    } catch (err) {\r\n        console.error(err);\r\n        Alert.alert('Error', 'No se pudo compartir el journey');\r\n        return false;\r\n    }\r\n}; "],"mappings":"AAAA,SAASA,QAAQ,QAAQ,YAAY;AAAC,OAAAC,KAAA;AAEtC,SAASC,6BAA6B,QAAQ,wBAAwB;AAQtE,OAAO,MAAMC,YAAY,GAAG,MAAAA,CACxBC,SAAiB,EACjBC,OAAe,EACfC,MAAc,KACK;EACnB,IAAI,CAACF,SAAS,EAAE;IACZH,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,wEAAwE,CAAC;IAC9F,OAAO,KAAK;EAChB;EAEA,IAAI;IAEA,MAAM;MAAEC,IAAI,EAAEC,WAAW;MAAEC,KAAK,EAAEC;IAAa,CAAC,GAAG,MAAMX,QAAQ,CAC5DY,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC,aAAa,CAAC,CACrBC,EAAE,CAAC,IAAI,EAAEV,SAAS,CAAC,CACnBW,MAAM,CAAC,CAAC;IAEb,IAAIJ,YAAY,EAAE,MAAMA,YAAY;IAGpC,MAAM;MAAED;IAAM,CAAC,GAAG,MAAMV,QAAQ,CAC3BY,IAAI,CAAC,iBAAiB,CAAC,CACvBI,MAAM,CAAC;MACJZ,SAAS;MACTC,OAAO;MACPY,gBAAgB,EAAEX,MAAM,CAACY;IAC7B,CAAC,CAAC;IAEN,IAAIR,KAAK,EAAE,MAAMA,KAAK;IAGtB,MAAMR,6BAA6B,CAC/BI,MAAM,CAACY,OAAO,EACdZ,MAAM,CAACa,QAAQ,EACfV,WAAW,EAAEW,WAAW,IAAI,UAChC,CAAC;IAEDnB,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,0BAA0BD,MAAM,CAACa,QAAQ,EAAE,CAAC;IACjE,OAAO,IAAI;EACf,CAAC,CAAC,OAAOE,GAAG,EAAE;IACVC,OAAO,CAACZ,KAAK,CAACW,GAAG,CAAC;IAClBpB,KAAK,CAACM,KAAK,CAAC,OAAO,EAAE,iCAAiC,CAAC;IACvD,OAAO,KAAK;EAChB;AACJ,CAAC","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}